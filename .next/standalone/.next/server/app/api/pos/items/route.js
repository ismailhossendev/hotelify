"use strict";(()=>{var e={};e.id=7545,e.ids=[7545,6511],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},25841:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>I,originalPathname:()=>b,patchFetch:()=>j,requestAsyncStorage:()=>v,routeModule:()=>x,serverHooks:()=>q,staticGenerationAsyncStorage:()=>k,staticGenerationBailout:()=>R});var n={};r.r(n),r.d(n,{GET:()=>g,POST:()=>y});var o=r(95419),s=r(69108),a=r(99678),i=r(98984),u=r(56511),c=r(11185),l=r.n(c);let p=new(l()).Schema({hotelId:{type:l().Schema.Types.ObjectId,ref:"Hotel",required:!0,index:!0},name:{type:String,required:!0},description:String,category:{type:String,enum:["food","beverage","snack","gift","service","other"]},price:{type:Number,required:!0},cost:{type:Number,default:0},trackInventory:{type:Boolean,default:!1},quantity:{type:Number,default:0},lowStockThreshold:{type:Number,default:5},image:String,isActive:{type:Boolean,default:!0},sortOrder:{type:Number,default:0}},{timestamps:!0}),d=l().models.ShopItem||l().model("ShopItem",p);var m=r(96467),f=r(65256);let h=f.Ry({name:f.Z_().min(1),category:f.Km(["food","beverage","snack","gift","service","other"]),price:f.Rx().positive(),cost:f.Rx().optional(),trackInventory:f.O7().default(!1),quantity:f.Rx().default(0)});async function y(e){try{let t=await (0,m.ts)();if(!t||!t.hotelId)return i.NextResponse.json({error:"Unauthorized"},{status:401});await (0,u.default)();let r=await e.json(),n=h.safeParse(r);if(!n.success)return i.NextResponse.json({error:"Validation failed"},{status:400});let o=await d.create({...n.data,hotelId:t.hotelId});return i.NextResponse.json({success:!0,item:o},{status:201})}catch(e){return i.NextResponse.json({error:"Internal server error"},{status:500})}}async function g(e){try{let e=await (0,m.ts)();if(!e||!e.hotelId)return i.NextResponse.json({error:"Unauthorized"},{status:401});await (0,u.default)();let t=await d.find({hotelId:e.hotelId,isActive:!0}).sort({category:1,name:1});return i.NextResponse.json({success:!0,items:t})}catch(e){return i.NextResponse.json({error:"Internal server error"},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/pos/items/route",pathname:"/api/pos/items",filename:"route",bundlePath:"app/api/pos/items/route"},resolvedPagePath:"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\api\\pos\\items\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:v,staticGenerationAsyncStorage:k,serverHooks:q,headerHooks:I,staticGenerationBailout:R}=x,b="/api/pos/items/route";function j(){return(0,a.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:k})}},96467:(e,t,r)=>{r.d(t,{WX:()=>u,setAuthCookie:()=>c,signToken:()=>i,ts:()=>l});var n=r(46082),o=r.n(n),s=r(7439);let a=process.env.JWT_SECRET||"fallback-secret-key-change-me";function i(e,t="6h"){return o().sign(e,a,{expiresIn:t})}function u(e){try{return o().verify(e,a)}catch(e){return null}}function c(e,t=21600){(0,s.cookies)().set("auth_token",e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:t,path:"/"})}async function l(){let e=function(){let e=(0,s.cookies)();return e.get("auth_token")?.value}();return e?u(e):null}},56511:(e,t,r)=>{r.d(t,{default:()=>i});var n=r(11185),o=r.n(n);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=global.mongoose;a||(a=global.mongoose={conn:null,promise:null});let i=async function(){if(a.conn)return a.conn;a.promise||(a.promise=o().connect(s,{bufferCommands:!1}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1638,7439,6082,2791,5256],()=>r(25841));module.exports=n})();