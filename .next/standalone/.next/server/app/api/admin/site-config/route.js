"use strict";(()=>{var e={};e.id=2988,e.ids=[2988,6511],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},60133:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>v,originalPathname:()=>k,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>y,serverHooks:()=>b,staticGenerationAsyncStorage:()=>S,staticGenerationBailout:()=>x});var n={};r.r(n),r.d(n,{GET:()=>f,PATCH:()=>m});var i=r(95419),a=r(69108),o=r(99678),s=r(98984),l=r(11185),u=r.n(l),d=r(56511),c=r(88607),p=r(96467),g=r(60795);async function f(e){try{let e=await (0,p.ts)();if(!e||"super_admin"!==e.role)return s.NextResponse.json({error:"Unauthorized"},{status:403});await (0,d.default)();let t=await c.l.findOne().sort({updatedAt:-1});return s.NextResponse.json({success:!0,config:t})}catch(e){return s.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let t=await (0,p.ts)();if(!t||"super_admin"!==t.role)return s.NextResponse.json({error:"Unauthorized"},{status:403});await (0,d.default)();let r=await e.json(),n=await c.l.findOne().sort({updatedAt:-1});return n?(n.hero={...n.hero,...r.hero},n.featured={...n.featured,...r.featured},n.features=r.features||n.features,n.updatedBy=new(u()).Types.ObjectId(t.userId),await n.save()):n=await c.l.create({...r,updatedBy:new(u()).Types.ObjectId(t.userId)}),await g.o.create({userId:t.userId,action:"settings_change",entityType:"SiteConfig",entityId:n._id,description:"Updated homepage configuration"}),s.NextResponse.json({success:!0,config:n})}catch(e){return console.error("Site Config Update Error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let y=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/site-config/route",pathname:"/api/admin/site-config",filename:"route",bundlePath:"app/api/admin/site-config/route"},resolvedPagePath:"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\api\\admin\\site-config\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:S,serverHooks:b,headerHooks:v,staticGenerationBailout:x}=y,k="/api/admin/site-config/route";function w(){return(0,o.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:S})}},96467:(e,t,r)=>{r.d(t,{WX:()=>l,setAuthCookie:()=>u,signToken:()=>s,ts:()=>d});var n=r(46082),i=r.n(n),a=r(7439);let o=process.env.JWT_SECRET||"fallback-secret-key-change-me";function s(e,t="6h"){return i().sign(e,o,{expiresIn:t})}function l(e){try{return i().verify(e,o)}catch(e){return null}}function u(e,t=21600){(0,a.cookies)().set("auth_token",e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:t,path:"/"})}async function d(){let e=function(){let e=(0,a.cookies)();return e.get("auth_token")?.value}();return e?l(e):null}},56511:(e,t,r)=>{r.d(t,{default:()=>s});var n=r(11185),i=r.n(n);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=i().connect(a,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},60795:(e,t,r)=>{r.d(t,{o:()=>o});var n=r(11185),i=r.n(n);let a=new(i()).Schema({hotelId:{type:i().Schema.Types.ObjectId,ref:"Hotel",index:!0},userId:{type:i().Schema.Types.ObjectId,ref:"User",required:!0},action:{type:String,enum:["login","logout","failed_login","create","update","delete","booking_confirm","booking_cancel","booking_checkout","payment_received","withdrawal_request","withdrawal_approve","settings_change","permission_change"],required:!0},entityType:String,entityId:i().Schema.Types.ObjectId,changes:{before:i().Schema.Types.Mixed,after:i().Schema.Types.Mixed},description:String,ipAddress:String,userAgent:String,isImmutable:{type:Boolean,default:!0}},{timestamps:{createdAt:!0,updatedAt:!1}});a.index({hotelId:1,createdAt:-1}),a.index({userId:1,action:1}),a.index({entityType:1,entityId:1});let o=i().models.AuditLog||i().model("AuditLog",a)},88607:(e,t,r)=>{r.d(t,{l:()=>o});var n=r(11185),i=r.n(n);let a=new(i()).Schema({hero:{title:{type:String,default:"Find your perfect stay"},subtitle:{type:String,default:"Search hundreds of hotels, resorts, and vacation rentals for your next trip."},backgroundImage:{type:String,default:""}},featured:{title:{type:String,default:"Trending Destinations"},subtitle:{type:String,default:"Most popular choices for travelers"},hotels:[{type:i().Schema.Types.ObjectId,ref:"Hotel"}],hotelIds:[{type:i().Schema.Types.ObjectId,ref:"Hotel"}]},categories:{enabled:{type:Boolean,default:!0},title:{type:String,default:"Browse by Category"},subtitle:{type:String,default:"Find the perfect accommodation for your travel style"},items:[{id:String,name:String,description:String,icon:String,color:String}]},destinations:{enabled:{type:Boolean,default:!0},title:{type:String,default:"Popular Destinations"},subtitle:{type:String,default:"Discover the most sought-after travel destinations"},items:[{name:String,image:String,hotelCount:Number,startingPrice:Number}]},offers:{enabled:{type:Boolean,default:!0},title:{type:String,default:"Exclusive Offers & Deals"},subtitle:{type:String,default:"Grab amazing discounts and save on your next booking"},items:[{title:String,discount:String,description:String,promoCode:String,validUntil:String,bgColor:String,image:String}]},testimonials:{enabled:{type:Boolean,default:!0},title:{type:String,default:"What Our Guests Say"},subtitle:{type:String,default:"Hear from travelers who made unforgettable memories"},items:[{name:String,location:String,avatar:String,rating:Number,hotel:String,review:String}]},features:[{title:String,description:String,icon:String}],header:{contact:{phone:{type:String,default:"+880 1700-000000"},email:{type:String,default:"info@hotelify.com"}},navigation:[{label:String,href:String}],topBarLinks:[{label:String,href:String}]},footer:{description:{type:String,default:"Discover and book the best hotels across Bangladesh. Your comfort is our priority."},socialLinks:{facebook:{type:String,default:"https://facebook.com"},twitter:{type:String,default:"https://twitter.com"},instagram:{type:String,default:"https://instagram.com"},linkedin:{type:String,default:"https://linkedin.com"}},quickLinks:[{label:String,href:String}],supportLinks:[{label:String,href:String}],copyrightText:{type:String,default:"\xa9 2024 Hotelify. All rights reserved."}},updatedBy:{type:i().Schema.Types.ObjectId,ref:"User"}},{timestamps:!0});i().models.SiteConfig&&delete i().models.SiteConfig;let o=i().model("SiteConfig",a)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1638,7439,6082,2791],()=>r(60133));module.exports=n})();