(()=>{var e={};e.id=608,e.ids=[608],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},12781:e=>{"use strict";e.exports=require("stream")},73837:e=>{"use strict";e.exports=require("util")},35816:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var a=s(50482),r=s(69108),l=s(62563),n=s.n(l),i=s(68300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["vendor",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,83593)),"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\vendor\\bookings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,91228)),"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\vendor\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,21342)),"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\vendor\\bookings\\page.tsx"],x="/vendor/bookings/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/vendor/bookings/page",pathname:"/vendor/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},4239:(e,t,s)=>{Promise.resolve().then(s.bind(s,46636))},55794:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},71532:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},97751:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},95269:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},67970:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},53148:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},20439:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]])},56389:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},28765:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3380:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},18822:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(73098).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},46636:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>D});var a=s(95344),r=s(3729),l=s(35705),n=s(56389),i=s(28765);function d({onClose:e,onSuccess:t}){let[s,d]=(0,r.useState)(1),[o,c]=(0,r.useState)(!1),[x,u]=(0,r.useState)(""),[m,g]=(0,r.useState)({checkIn:(0,l.WU)(new Date,"yyyy-MM-dd"),checkOut:(0,l.WU)(new Date(Date.now()+864e5),"yyyy-MM-dd")}),[h,p]=(0,r.useState)([]),[b,y]=(0,r.useState)([]),[j,v]=(0,r.useState)(!1),[f,N]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[C,S]=(0,r.useState)({name:"",phone:"",email:"",address:""}),[_,D]=(0,r.useState)({adults:1,children:0}),[M,Z]=(0,r.useState)(""),I=async e=>{e&&e.preventDefault(),v(!0),u("");try{let e=await fetch("/api/rooms"),t=await e.json();t.success?(p(t.rooms),d(2)):u("Failed to load rooms")}catch(e){u("Failed to check availability")}finally{v(!1)}},U=async e=>{e.preventDefault(),c(!0),u("");try{let e=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:f._id,roomUnitId:w||void 0,checkIn:new Date(m.checkIn).toISOString(),checkOut:new Date(m.checkOut).toISOString(),guestDetails:C,guests:_,specialRequests:M})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to create booking");t()}catch(e){u(e.message)}finally{c(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[a.jsx("h2",{className:"text-lg font-bold",children:"New Booking"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-black",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto",children:[x&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-600 rounded-lg text-sm",children:x}),1===s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Check In"}),a.jsx("input",{type:"date",className:"w-full p-2 border rounded-lg",value:m.checkIn,onChange:e=>g({...m,checkIn:e.target.value})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Check Out"}),a.jsx("input",{type:"date",className:"w-full p-2 border rounded-lg",value:m.checkOut,onChange:e=>g({...m,checkOut:e.target.value})})]})]}),a.jsx("button",{onClick:I,disabled:j,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-medium flex items-center justify-center gap-2",children:j?a.jsx(n.Z,{className:"animate-spin h-5 w-5"}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(i.Z,{className:"h-4 w-4"})," Check Availability"]})})]}):a.jsx("form",{onSubmit:U,className:"space-y-6",children:f?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-bold text-blue-900",children:f.name}),(0,a.jsxs)("div",{className:"text-xs text-blue-700",children:[(0,l.WU)(new Date(m.checkIn),"MMM d")," - ",(0,l.WU)(new Date(m.checkOut),"MMM d")]})]}),a.jsx("button",{type:"button",onClick:()=>{N(null),k("")},className:"text-xs text-blue-600 hover:underline",children:"Change"})]}),(0,a.jsxs)("div",{className:"pt-2 border-t border-blue-200",children:[a.jsx("label",{className:"text-xs font-bold text-blue-800 block mb-1",children:"Assign Room Number (Optional)"}),(0,a.jsxs)("select",{className:"w-full text-sm border-blue-200 rounded p-1",value:w,onChange:e=>k(e.target.value),onClick:()=>{0===b.length&&fetch("/api/room-units").then(e=>e.json()).then(e=>{e.success&&y(e.units.filter(e=>e.roomTypeId===f._id))})},children:[a.jsx("option",{value:"",children:"Auto-Assign Later"}),b.map(e=>(0,a.jsxs)("option",{value:e._id,disabled:"clean"!==e.status,children:[e.roomNo," (",e.status,")"]},e._id))]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Guest Name *"}),a.jsx("input",{required:!0,className:"w-full p-2 border rounded-lg",value:C.name,onChange:e=>S({...C,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Phone *"}),a.jsx("input",{required:!0,type:"tel",className:"w-full p-2 border rounded-lg",value:C.phone,onChange:e=>S({...C,phone:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Adults"}),a.jsx("input",{type:"number",min:"1",className:"w-full p-2 border rounded-lg",value:_.adults,onChange:e=>D({..._,adults:parseInt(e.target.value)})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium block mb-1",children:"Children"}),a.jsx("input",{type:"number",min:"0",className:"w-full p-2 border rounded-lg",value:_.children,onChange:e=>D({..._,children:parseInt(e.target.value)})})]})]}),a.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-70 mt-4",children:o?a.jsx(n.Z,{className:"animate-spin h-5 w-5 mx-auto"}):"Confirm Booking"})]}):(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Select Room"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.map(e=>(0,a.jsxs)("div",{onClick:()=>N(e),className:"border p-3 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all",children:[a.jsx("div",{className:"font-bold",children:e.name}),a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:e.roomType}),(0,a.jsxs)("div",{className:"text-sm font-medium text-blue-600 mt-1",children:["BDT ",e.basePrice]})]},e._id))}),a.jsx("button",{type:"button",onClick:()=>d(1),className:"mt-4 text-sm text-gray-500 underline",children:"Change Dates"})]})})]})]})})}var o=s(27087),c=s(10077),x=s(98037);function u(e,t,s){let a=(0,x.Q)(e,s?.in);return isNaN(t)?(0,c.L)(s?.in||e,NaN):(t&&a.setDate(a.getDate()+t),a)}var m=s(74727),g=s(84951),h=s(52764);function p(e,t,s){let[a,r]=(0,g.d)(s?.in,e,t),l=b(a,r),n=Math.abs((0,h.w)(a,r));a.setDate(a.getDate()-l*n);let i=Number(b(a,r)===-l),d=l*(n-i);return 0===d?0:d}function b(e,t){let s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}var y=s(71532),j=s(97751),v=s(95269),f=s(18822);function N({bookings:e,rooms:t,units:s}){let[n,i]=(0,r.useState)((0,o.b)(new Date)),d=(0,r.useMemo)(()=>Array.from({length:14}).map((e,t)=>u(n,t)),[n]),c=(0,r.useMemo)(()=>{let e=[];return t.forEach(t=>{let a=s.filter(e=>e.roomTypeId===t._id||e.roomTypeId?._id===t._id);e.push({type:"header",data:t}),a.forEach(s=>{e.push({type:"unit",data:s,parentType:t})}),e.push({type:"unassigned",data:{_id:`unassigned-${t._id}`,name:"Unassigned",roomTypeId:t._id},parentType:t})}),e},[t,s]);return(0,a.jsxs)("div",{className:"bg-white border rounded-xl shadow-sm overflow-hidden flex flex-col h-[600px]",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("h2",{className:"font-bold text-lg text-gray-700",children:(0,l.WU)(n,"MMMM yyyy")}),(0,a.jsxs)("div",{className:"flex bg-white rounded-lg border shadow-sm",children:[a.jsx("button",{onClick:()=>i(u(n,-7)),className:"p-2 hover:bg-gray-100 border-r",children:a.jsx(y.Z,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>i((0,o.b)(new Date)),className:"px-4 text-sm font-medium hover:bg-gray-100",children:"Today"}),a.jsx("button",{onClick:()=>i(u(n,7)),className:"p-2 hover:bg-gray-100 border-l",children:a.jsx(j.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-200 rounded-sm"})," Confirmed"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-red-200 rounded-sm"})," Unassigned"]})]})]}),a.jsx("div",{className:"flex-1 overflow-auto relative",children:(0,a.jsxs)("div",{className:"min-w-[1200px]",children:[(0,a.jsxs)("div",{className:"grid grid-cols-[250px_repeat(14,1fr)] sticky top-0 bg-white z-10 border-b shadow-sm",children:[a.jsx("div",{className:"p-3 font-bold text-gray-500 border-r bg-gray-50",children:"Room / Unit"}),d.map((e,t)=>(0,a.jsxs)("div",{className:`p-2 text-center border-r border-gray-100 ${(0,m.K)(e,new Date)?"bg-blue-50":""}`,children:[a.jsx("div",{className:"text-xs font-medium text-gray-500",children:(0,l.WU)(e,"EEE")}),a.jsx("div",{className:`font-bold ${(0,m.K)(e,new Date)?"text-blue-600":"text-gray-700"}`,children:(0,l.WU)(e,"d")})]},t))]}),a.jsx("div",{className:"divide-y",children:c.map((t,s)=>{if("header"===t.type)return a.jsx("div",{className:"grid grid-cols-[250px_repeat(14,1fr)] bg-gray-100 border-b",children:(0,a.jsxs)("div",{className:"p-2 px-4 font-bold text-gray-800 col-span-full flex items-center gap-2",children:[t.data.name,(0,a.jsxs)("span",{className:"text-xs font-normal bg-white px-2 py-0.5 rounded border text-gray-500",children:[t.data.totalRooms||0," Rooms"]})]})},`header-${t.data._id}`);let r="unassigned"===t.type,l=t.data._id,i=t.parentType._id;return(0,a.jsxs)("div",{className:`grid grid-cols-[250px_repeat(14,1fr)] group hover:bg-gray-50 transition-colors relative h-16 ${r?"bg-stripes-gray":""}`,children:[a.jsx("div",{className:"p-3 border-r bg-white sticky left-0 z-10 border-b-0 flex items-center justify-between group-hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[r?a.jsx("div",{className:"h-8 w-8 rounded bg-red-50 flex items-center justify-center text-red-500",children:a.jsx(v.Z,{className:"h-4 w-4"})}):a.jsx("div",{className:"h-8 w-8 rounded bg-blue-50 flex items-center justify-center font-bold text-blue-700 text-sm",children:t.data.roomNo}),a.jsx("div",{className:"text-sm font-medium text-gray-700",children:r?"Requires Assignment":t.data.floor||"1st Floor"})]})}),d.map((e,t)=>a.jsx("div",{className:"border-r border-gray-100 h-full"},t)),e.filter(e=>r?!e.roomUnitId&&(e.roomId?._id===i||e.roomId===i):e.roomUnitId===l||e.roomUnitId?._id===l).map(e=>{let t=new Date(e.checkIn),s=new Date(e.checkOut),l=p(t,n),i=p(s,t);if(l+i<0||l>=14)return null;let d=Math.max(0,l),o=Math.min(14,l+i)-d;if(o<=0)return null;let c=`span ${o}`;return(0,a.jsxs)("div",{style:{gridColumn:`${d+2} / ${c}`},className:`absolute top-2 bottom-2 left-1 right-1 rounded-lg border px-2 py-1 flex items-center gap-2 text-xs font-semibold shadow-sm cursor-pointer z-0 overflow-hidden whitespace-nowrap 
                                                    ${r?"bg-red-100 border-red-300 animate-pulse":({confirmed:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",checked_in:"bg-blue-100 text-blue-800 border-blue-200"})[e.status]||"bg-gray-100"}
                                                `,title:`Guest: ${e.guestDetails?.name}`,onClick:()=>window.location.href=`/bookings/${e._id}`,children:[a.jsx(f.Z,{className:"h-3 w-3 shrink-0"}),a.jsx("span",{className:"truncate",children:e.guestDetails?.name||"Guest"})]},e._id)})]},l)})})]})})]})}var w=s(20439),k=s(55794),C=s(53148),S=s(67970),_=s(3380);function D(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[x,u]=(0,r.useState)(!0),[m,g]=(0,r.useState)("list"),[h,p]=(0,r.useState)(!1),[b,y]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[f,D]=(0,r.useState)(""),[Z,I]=(0,r.useState)(""),[U,P]=(0,r.useState)(""),[q,A]=(0,r.useState)(""),[$,O]=(0,r.useState)(""),[T,z]=(0,r.useState)(""),[E,G]=(0,r.useState)(""),[R,L]=(0,r.useState)([]),[B,W]=(0,r.useState)([]),[F,V]=(0,r.useState)(0);(0,r.useEffect)(()=>{H()},[]);let H=()=>{Promise.all([fetch("/api/bookings").then(e=>e.json()),fetch("/api/rooms").then(e=>e.json()),fetch("/api/room-units").then(e=>e.json())]).then(([e,s,a])=>{e.success&&t(e.bookings),s.success&&i(s.rooms),a.success&&c(a.units),u(!1)})},K=e=>{y(e),D(e.status),I(e.paymentStatus),P(e.guestDetails?.name||""),A(e.guestDetails?.phone||""),O(e.guestDetails?.email||""),z(e.guestDetails?.nid||""),G(e.guestDetails?.address||""),L(e.guestDetails?.documents||[]),W(e.additionalGuests||[]),V(e.pricing?.discount||0)},J=async()=>{if(!b)return;v(!0);let s=(b.pricing?.subtotal||0)+(b.pricing?.taxes||0)-F;try{let a=await fetch(`/api/bookings/${b._id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:f,paymentStatus:Z,guestDetails:{name:U,phone:q,email:$,nid:T,address:E,documents:R},additionalGuests:B,pricing:{discount:F,totalAmount:s}})}),r=await a.json();r.success?(t(e.map(e=>e._id===b._id?r.booking:e)),y(r.booking),alert("Booking updated successfully")):alert(r.error||"Failed to update")}catch(e){alert("Error updating booking")}finally{v(!1)}},X=e=>{let t=[...B];t.splice(e,1),W(t)},Y=(e,t,s)=>{let a=[...B];a[e]={...a[e],[t]:s},W(a)},Q=e=>{let t=[...R];t.splice(e,1),L(t)},ee=(e,t,s)=>{let a=[...R];a[e]={...a[e],[t]:s},L(a)},et=async(e,t)=>{let s=t.target.files?.[0];if(!s)return;let a=new FormData;a.append("file",s);try{let t=await fetch("/api/upload",{method:"POST",body:a}),s=await t.json();s.success?ee(e,"url",s.url):alert("Upload failed")}catch{alert("Upload error")}};return x?a.jsx("div",{className:"flex h-screen items-center justify-center",children:a.jsx(n.Z,{className:"animate-spin h-8 w-8 text-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Bookings"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Manage guest reservations and occupancy"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-100 p-1 rounded-lg flex border border-gray-200",children:[a.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-md transition-all ${"list"===m?"bg-white shadow text-blue-600":"text-gray-500 hover:text-gray-900"}`,title:"List View",children:a.jsx(w.Z,{className:"h-5 w-5"})}),a.jsx("button",{onClick:()=>g("calendar"),className:`p-2 rounded-md transition-all ${"calendar"===m?"bg-white shadow text-blue-600":"text-gray-500 hover:text-gray-900"}`,title:"Calendar View",children:a.jsx(k.Z,{className:"h-5 w-5"})})]}),a.jsx("button",{onClick:()=>p(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 shadow-lg shadow-blue-600/20",children:"+ New Booking"})]})]}),h&&a.jsx(d,{onClose:()=>p(!1),onSuccess:()=>{p(!1),H()}}),"calendar"===m?a.jsx("div",{className:"animate-in fade-in duration-300",children:a.jsx(N,{bookings:e,rooms:s,units:o})}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden animate-in fade-in duration-300",children:(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-4",children:"Booking ID"}),a.jsx("th",{className:"px-6 py-4",children:"Guest"}),a.jsx("th",{className:"px-6 py-4",children:"Room"}),a.jsx("th",{className:"px-6 py-4",children:"Dates"}),a.jsx("th",{className:"px-6 py-4",children:"Status"}),a.jsx("th",{className:"px-6 py-4",children:"Amount"}),a.jsx("th",{className:"px-6 py-4",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y",children:0===e.length?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No bookings found"})}):e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 font-mono font-medium text-gray-900",children:e.bookingNumber||e._id.slice(-6).toUpperCase()}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.guestDetails?.name||e.guestId?.profile?.name}),a.jsx("div",{className:"text-xs text-gray-500",children:e.guestDetails?.phone})]}),(0,a.jsxs)("td",{className:"px-6 py-4 text-gray-600",children:[a.jsx("div",{className:"font-medium",children:e.roomId?.name}),e.roomUnitId?(0,a.jsxs)("div",{className:"text-xs text-blue-600 font-bold mt-1",children:["Room ",e.roomUnitId.roomNo]}):a.jsx("div",{className:"text-xs text-orange-500 font-medium mt-1",children:"Unassigned"})]}),(0,a.jsxs)("td",{className:"px-6 py-4 text-gray-600",children:[(0,l.WU)(new Date(e.checkIn),"MMM d")," - ",(0,l.WU)(new Date(e.checkOut),"MMM d")]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx(M,{status:e.status})}),(0,a.jsxs)("td",{className:"px-6 py-4 font-bold text-gray-900",children:["৳",e.pricing?.totalAmount||e.totalAmount||0]}),a.jsx("td",{className:"px-6 py-4 flex gap-2",children:(0,a.jsxs)("button",{onClick:()=>K(e),className:"text-blue-600 hover:text-blue-800 font-medium hover:underline flex items-center gap-1",children:[a.jsx(C.Z,{className:"h-4 w-4"})," View"]})})]},e._id))})]})}),b&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-end bg-black/50 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"w-full max-w-2xl h-full bg-white shadow-2xl p-6 overflow-y-auto animate-in slide-in-from-right duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Booking Details"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",b.bookingNumber||b._id]})]}),a.jsx("button",{onClick:()=>y(null),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500",children:a.jsx(S.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Management"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Booking Status"}),(0,a.jsxs)("select",{value:f,onChange:e=>D(e.target.value),className:"w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-gray-900",children:[a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"checked_in",children:"Checked In"}),a.jsx("option",{value:"checked_out",children:"Checked Out"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Payment Status"}),(0,a.jsxs)("select",{value:Z,onChange:e=>I(e.target.value),className:"w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-gray-900",children:[a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"partial",children:"Partial"}),a.jsx("option",{value:"paid",children:"Paid"}),a.jsx("option",{value:"refunded",children:"Refunded"})]})]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:J,disabled:j,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors flex items-center gap-2",children:j?"Saving...":"Update Booking"})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Guest Information"}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200 space-y-3 shadow-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Name"}),a.jsx("input",{type:"text",value:U,onChange:e=>P(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Phone"}),a.jsx("input",{type:"text",value:q,onChange:e=>A(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Email"}),a.jsx("input",{type:"email",value:$,onChange:e=>O(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"NID"}),a.jsx("input",{type:"text",value:T,onChange:e=>z(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Address"}),a.jsx("input",{type:"text",value:E,onChange:e=>G(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider",children:"Documents"}),a.jsx("button",{onClick:()=>{L([...R,{type:"ID/Passport",url:""}])},className:"text-xs bg-gray-100 hover:bg-gray-200 text-blue-600 border border-gray-300 rounded px-2 py-1 transition-colors",children:"+ Add Doc"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[R.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{type:"text",value:e.type,onChange:e=>ee(t,"type",e.target.value),className:"w-1/3 bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none",placeholder:"Type"}),(0,a.jsxs)("div",{className:"flex-1 flex gap-1",children:[a.jsx("input",{type:"text",value:e.url,onChange:e=>ee(t,"url",e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm focus:border-blue-500 outline-none",placeholder:"URL or Upload"}),(0,a.jsxs)("label",{className:"cursor-pointer bg-gray-100 hover:bg-gray-200 border border-gray-300 text-gray-700 rounded px-2 flex items-center justify-center transition-colors",title:"Upload File",children:[a.jsx(_.Z,{className:"h-4 w-4"}),a.jsx("input",{type:"file",className:"hidden",onChange:e=>et(t,e)})]}),e.url&&a.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-100 hover:bg-gray-200 border border-gray-300 text-blue-600 rounded px-2 flex items-center justify-center transition-colors",title:"View",children:a.jsx(C.Z,{className:"h-4 w-4"})})]}),a.jsx("button",{onClick:()=>Q(t),className:"text-gray-400 hover:text-red-500",children:a.jsx(S.Z,{className:"h-5 w-5"})})]},t)),0===R.length&&a.jsx("div",{className:"text-xs text-gray-500 italic",children:"No documents attached."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider",children:"Additional Guests"}),a.jsx("button",{onClick:()=>{W([...B,{name:"",age:"",nid:""}])},className:"text-xs bg-gray-100 hover:bg-gray-200 text-blue-600 border border-gray-300 rounded px-2 py-1 transition-colors",children:"+ Add Guest"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[B.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-xl p-3 border border-gray-200 relative group",children:[a.jsx("button",{onClick:()=>X(t),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove Guest",children:a.jsx(S.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-500 uppercase",children:"Name"}),a.jsx("input",{type:"text",value:e.name,onChange:e=>Y(t,"name",e.target.value),className:"w-full bg-white border-b border-gray-300 text-gray-900 text-sm py-1 focus:border-blue-500 outline-none",placeholder:"Guest Name"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-500 uppercase",children:"NID / ID"}),a.jsx("input",{type:"text",value:e.nid||"",onChange:e=>Y(t,"nid",e.target.value),className:"w-full bg-white border-b border-gray-300 text-gray-900 text-sm py-1 focus:border-blue-500 outline-none",placeholder:"Optional"})]})]})]},t)),0===B.length&&a.jsx("div",{className:"text-center py-4 bg-gray-50 rounded-lg border border-dashed border-gray-300 text-gray-500 text-xs",children:"No additional guests added."})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Payment Info"}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200 space-y-2 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Subtotal"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["৳",b.pricing?.subtotal?.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-500",children:"Discount"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-500 text-xs",children:"৳"}),a.jsx("input",{type:"number",value:F,onChange:e=>V(Number(e.target.value)),className:"w-20 bg-gray-50 border border-gray-300 rounded px-2 py-1 text-gray-900 text-sm text-right focus:border-blue-500 outline-none"})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-2 flex justify-between font-bold text-lg",children:[a.jsx("span",{className:"text-gray-900",children:"Total"}),(0,a.jsxs)("span",{className:"text-blue-600",children:["৳",((b.pricing?.subtotal||0)+(b.pricing?.taxes||0)-F).toLocaleString()]})]})]})]})]})]})})]})}function M({status:e}){return a.jsx("span",{className:`px-2.5 py-1 rounded-md text-xs font-bold uppercase tracking-wider ${{confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-50 text-red-700 border border-red-200",checked_in:"bg-blue-100 text-blue-700 border border-blue-200",checked_out:"bg-gray-100 text-gray-700 border border-gray-200"}[e]||"bg-gray-100"}`,children:e?.replace("_"," ")})}},99365:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(40002),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:d,className:o="",children:c,...x},u)=>(0,a.createElement)("svg",{ref:u,...r,width:n,height:n,stroke:s,strokeWidth:d?24*Number(i)/Number(n):i,className:["lucide",`lucide-${l(e)}`,o].join(" "),...x},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(c)?c:[c]]));return s.displayName=`${e}`,s}},68631:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(99365).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},66506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(99365).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},78953:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(99365).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},16274:(e,t,s)=>{"use strict";s.d(t,{default:()=>r.a});var a=s(48026),r=s.n(a)},48026:(e,t,s)=>{"use strict";let{createProxy:a}=s(86843);e.exports=a("C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\node_modules\\next\\dist\\client\\link.js")},83593:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>r,default:()=>n});let a=(0,s(86843).createProxy)(String.raw`C:\Users\ismai\.gemini\antigravity\playground\primal-supernova\src\app\vendor\bookings\page.tsx`),{__esModule:r,$$typeof:l}=a,n=a.default},74727:(e,t,s)=>{"use strict";s.d(t,{K:()=>l});var a=s(84951),r=s(27087);function l(e,t,s){let[l,n]=(0,a.d)(s?.in,e,t);return+(0,r.b)(l)==+(0,r.b)(n)}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[1638,7439,6082,7217,1476,867,4298,1091],()=>s(35816));module.exports=a})();