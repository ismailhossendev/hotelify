(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4152],{32887:function(e,s,t){Promise.resolve().then(t.bind(t,21595))},53879:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},34187:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},59886:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},79580:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},63915:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},70699:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},47907:function(e,s,t){"use strict";var a=t(15313);t.o(a,"notFound")&&t.d(s,{notFound:function(){return a.notFound}}),t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},21595:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var a=t(57437),n=t(2265),i=t(47907),l=t(19139),r=t(79580),d=t(53879),o=t(63915),c=t(34187),u=t(59886),x=t(70699);function m(){var e,s,t,m,h,g;let p=(0,i.useParams)(),b=(0,i.useRouter)(),[_,j]=(0,n.useState)(null),[y,v]=(0,n.useState)(!0),[f,N]=(0,n.useState)(!1),[k,w]=(0,n.useState)([]),[C,D]=(0,n.useState)(!1),[G,S]=(0,n.useState)({name:"",phone:"",email:"",nid:"",address:"",nationality:"Bangladeshi",notes:"",additionalGuests:[]});(0,n.useEffect)(()=>{fetch("/api/bookings/".concat(p.id)).then(e=>e.json()).then(e=>{if(e.success){var s,t,a,n,i,l;j(e.booking),S({name:(null===(s=e.booking.guestDetails)||void 0===s?void 0:s.name)||"",phone:(null===(t=e.booking.guestDetails)||void 0===t?void 0:t.phone)||"",email:(null===(a=e.booking.guestDetails)||void 0===a?void 0:a.email)||"",nid:(null===(n=e.booking.guestDetails)||void 0===n?void 0:n.nid)||"",address:(null===(i=e.booking.guestDetails)||void 0===i?void 0:i.address)||"",nationality:(null===(l=e.booking.guestDetails)||void 0===l?void 0:l.nationality)||"Bangladeshi",notes:e.booking.specialRequests||"",additionalGuests:e.booking.additionalGuests||[]}),fetch("/api/room-units").then(e=>e.json()).then(s=>{s.success&&e.booking.roomId&&w(s.units.filter(s=>s.roomTypeId===e.booking.roomId._id))})}v(!1)}).catch(console.error)},[p.id]);let I=async e=>{if("update"===e||confirm("Are you sure you want to ".concat(e.replace("_"," "),"?")))try{let r={action:e};("check_in"===e||"update"===e)&&(r.guestDetails={name:G.name,phone:G.phone,email:G.email,nid:G.nid,address:G.address,nationality:G.nationality},r.specialRequests=G.notes,r.additionalGuests=G.additionalGuests);let d=await fetch("/api/bookings/".concat(p.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),o=await d.json();if(o.success){var s,t,a,n,i,l;j(o.booking),S({name:(null===(s=o.booking.guestDetails)||void 0===s?void 0:s.name)||"",phone:(null===(t=o.booking.guestDetails)||void 0===t?void 0:t.phone)||"",email:(null===(a=o.booking.guestDetails)||void 0===a?void 0:a.email)||"",nid:(null===(n=o.booking.guestDetails)||void 0===n?void 0:n.nid)||"",address:(null===(i=o.booking.guestDetails)||void 0===i?void 0:i.address)||"",nationality:(null===(l=o.booking.guestDetails)||void 0===l?void 0:l.nationality)||"Bangladeshi",notes:o.booking.specialRequests||"",additionalGuests:o.booking.additionalGuests||[]}),N(!1),"update"===e&&alert("Booking details updated successfully")}}catch(e){console.error(e),alert("Failed to update booking")}},P=async e=>{if(confirm("Assign/Change room to this unit?"))try{let s=await fetch("/api/bookings/".concat(p.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomUnitId:e})}),t=await s.json();t.success?(j(e=>({...e,roomUnitId:t.booking.roomUnitId})),D(!1),alert("Room assigned successfully")):alert(t.error||"Failed to assign room")}catch(e){alert("Error assigning room")}},A=e=>{S({...G,additionalGuests:G.additionalGuests.filter((s,t)=>t!==e)})},R=(e,s,t)=>{let a=[...G.additionalGuests];a[e]={...a[e],[s]:t},S({...G,additionalGuests:a})};if(y)return(0,a.jsx)("div",{className:"p-8",children:(0,a.jsx)(r.Z,{className:"animate-spin"})});if(!_)return(0,a.jsx)("div",{children:"Booking not found"});let Z=(null===(e=_.guestDetails)||void 0===e?void 0:e.documents)||[];return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6 pb-20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 print:hidden",children:[(0,a.jsx)("button",{onClick:()=>b.back(),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,a.jsx)(d.Z,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Booking Details"}),(0,a.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-4 py-2 border rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"})," Print"]}),(0,a.jsx)("button",{onClick:()=>N(!f),className:"flex items-center gap-2 px-4 py-2 rounded-lg border ".concat(f?"bg-gray-100 border-gray-300":"hover:bg-gray-50"),children:f?"Cancel Edit":"Edit Details"}),"pending"===_.status||"confirmed"===_.status?(0,a.jsxs)("button",{onClick:()=>f?I("check_in"):N(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"})," ",f?"Confirm Check In":"Check In"]}):null,"checked_in"===_.status&&(0,a.jsxs)("button",{onClick:()=>I("check_out"),className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"})," Check Out"]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-8 print:shadow-none print:border-0 print:p-0",children:[(0,a.jsxs)("div",{className:"border-b pb-6 mb-6 flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Hotelify Resort"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"123 Beach Road, Cox's Bazar"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Phone: +880 1234 567890"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Booking No"}),(0,a.jsx)("div",{className:"text-2xl font-mono font-bold",children:_.bookingNumber}),(0,a.jsx)("div",{className:"mt-2 inline-flex px-3 py-1 rounded-full text-xs font-bold uppercase\n                            ".concat("confirmed"===_.status?"bg-green-100 text-green-700":"checked_in"===_.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:_.status.replace("_"," ")})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Guest Information"}),f?(0,a.jsxs)("div",{className:"space-y-4 bg-gray-50 p-6 rounded-lg border border-gray-200 print:hidden",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Full Name"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.name,onChange:e=>S({...G,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Phone"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.phone,onChange:e=>S({...G,phone:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Email"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.email,onChange:e=>S({...G,email:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"NID / Passport"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.nid,onChange:e=>S({...G,nid:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Nationality"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.nationality,onChange:e=>S({...G,nationality:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Address"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded text-sm mt-1",value:G.address,onChange:e=>S({...G,address:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Additional Guests"}),G.additionalGuests.map((e,s)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{placeholder:"Name",className:"w-[40%] p-2 border rounded text-sm",value:e.name,onChange:e=>R(s,"name",e.target.value)}),(0,a.jsx)("input",{placeholder:"Age",className:"w-[20%] p-2 border rounded text-sm",value:e.age,onChange:e=>R(s,"age",e.target.value)}),(0,a.jsx)("input",{placeholder:"NID",className:"w-[30%] p-2 border rounded text-sm",value:e.nid,onChange:e=>R(s,"nid",e.target.value)}),(0,a.jsx)("button",{onClick:()=>A(s),className:"text-red-500",children:(0,a.jsx)(u.Z,{size:16})})]},s)),(0,a.jsx)("button",{onClick:()=>{S({...G,additionalGuests:[...G.additionalGuests,{name:"",age:"",nid:""}]})},className:"text-xs text-blue-600 font-bold hover:underline",children:"+ Add Guest"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Special Requests / Notes"}),(0,a.jsx)("textarea",{className:"w-full p-2 border rounded text-sm mt-1 h-20",value:G.notes,onChange:e=>S({...G,notes:e.target.value})})]}),(0,a.jsxs)("button",{onClick:()=>I("update"),className:"w-full bg-stone-900 text-white py-3 rounded-lg font-bold hover:bg-stone-800 flex items-center justify-center gap-2",children:[(0,a.jsx)(x.Z,{size:16})," Save Changes"]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-xl text-gray-900",children:_.guestDetails.name}),(0,a.jsx)("p",{className:"text-gray-600",children:_.guestDetails.phone}),(0,a.jsx)("p",{className:"text-gray-600",children:_.guestDetails.email})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Address:"}),(0,a.jsx)("div",{children:_.guestDetails.address||"-"}),(0,a.jsx)("div",{className:"text-gray-500",children:"NID / Passport:"}),(0,a.jsx)("div",{children:_.guestDetails.nid||"-"}),(0,a.jsx)("div",{className:"text-gray-500",children:"Nationality:"}),(0,a.jsx)("div",{children:_.guestDetails.nationality||"-"})]}),Z.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Attached Documents"}),(0,a.jsx)("div",{className:"flex gap-2",children:Z.map((e,s)=>(0,a.jsx)("div",{className:"relative group w-24 h-16 bg-gray-100 rounded border overflow-hidden cursor-pointer",onClick:()=>window.open(e.url,"_blank"),children:(0,a.jsx)("img",{src:e.url,alt:"Doc",className:"w-full h-full object-cover"})},s))})]}),_.additionalGuests&&_.additionalGuests.length>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,a.jsxs)("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:["Additional Guests (",_.additionalGuests.length,")"]}),(0,a.jsx)("ul",{className:"text-sm space-y-1",children:_.additionalGuests.map((e,s)=>(0,a.jsxs)("li",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:[e.name," ",(0,a.jsxs)("span",{className:"text-gray-400 text-xs",children:["(",e.age," yrs)"]})]}),(0,a.jsx)("span",{className:"text-gray-500 text-xs",children:e.nid})]},s))})]}),_.specialRequests&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,a.jsx)("p",{className:"text-xs font-bold text-gray-400 uppercase mb-1",children:"Special Requests"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 bg-yellow-50 p-3 rounded border border-yellow-100",children:_.specialRequests})]})]}),(0,a.jsxs)("div",{className:"hidden print:block mt-8 space-y-6 text-gray-400 text-sm",children:[!_.guestDetails.address&&(0,a.jsx)("div",{className:"border-b border-gray-300 py-2",children:"Address: __________________________________________________"}),!_.guestDetails.nid&&(0,a.jsx)("div",{className:"border-b border-gray-300 py-2",children:"ID No: ___________________________________________________"}),(0,a.jsx)("div",{className:"border-b border-gray-300 py-2 pt-8",children:"Guest Signature: ________________________________________________"}),(0,a.jsx)("div",{className:"border-b border-gray-300 py-2",children:"Authorized Signature: ____________________________________________"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Stay Information"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4 print:bg-transparent print:p-0 border print:border-0 border-gray-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Room Type"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-bold",children:null===(s=_.roomId)||void 0===s?void 0:s.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null===(t=_.roomId)||void 0===t?void 0:t.roomType})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-3",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Check In"}),(0,a.jsx)("span",{className:"font-bold",children:(0,l.WU)(new Date(_.checkIn),"dd MMM yyyy")})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Check Out"}),(0,a.jsx)("span",{className:"font-bold",children:(0,l.WU)(new Date(_.checkOut),"dd MMM yyyy")})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Duration"}),(0,a.jsxs)("span",{className:"font-bold",children:[_.nights," Nights"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t border-dashed border-gray-300 pt-4 mt-2",children:[(0,a.jsx)("span",{className:"font-bold text-xl",children:"Total Due"}),(0,a.jsxs)("span",{className:"font-bold text-xl text-blue-600 print:text-black",children:["BDT ",null===(m=_.pricing.totalAmount)||void 0===m?void 0:m.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Paid Amount"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:["BDT ",(null===(h=_.amountPaid)||void 0===h?void 0:h.toLocaleString())||0]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Balance Due"}),(0,a.jsxs)("span",{className:"font-bold text-red-500",children:["BDT ",((_.pricing.totalAmount||0)-(_.amountPaid||0)).toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"mt-8 print:hidden",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Room Assignment"}),_.roomUnitId?(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-green-600 font-bold uppercase",children:"Assigned Unit"}),(0,a.jsxs)("p",{className:"font-bold text-green-800",children:["Room ",(null===(g=_.roomUnitId)||void 0===g?void 0:g.name)||_.roomUnitId]})]}),(0,a.jsx)("button",{onClick:()=>D(!0),className:"text-xs bg-white border border-green-200 px-3 py-1 rounded hover:bg-green-100",children:"Change"})]}):(0,a.jsx)("button",{onClick:()=>D(!0),className:"w-full py-3 border-2 border-dashed border-gray-300 text-gray-500 rounded-lg hover:border-blue-500 hover:text-blue-500 transition-colors bg-gray-50",children:"+ Assign Room Number"}),C&&(0,a.jsxs)("div",{className:"mt-4 bg-white border rounded-lg p-4 shadow-lg animate-in fade-in slide-in-from-bottom-2",children:[(0,a.jsx)("p",{className:"text-sm font-bold mb-3",children:"Select a clean unit to assign:"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:k.length>0?k.map(e=>(0,a.jsxs)("button",{onClick:()=>P(e._id),disabled:"clean"!==e.status,className:"p-2 rounded text-xs border font-bold ".concat("clean"===e.status?"border-green-200 bg-green-50 hover:bg-green-100 text-green-700":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[e.name," (",e.status,")"]},e._id)):(0,a.jsx)("p",{className:"col-span-3 text-xs text-gray-400",children:"No units found for this room type."})}),(0,a.jsx)("button",{onClick:()=>D(!1),className:"mt-3 text-xs text-gray-500 hover:text-black",children:"Cancel"})]})]})]})]}),(0,a.jsxs)("div",{className:"hidden print:block fixed bottom-8 left-0 right-0 text-center text-gray-400 text-xs text-stone-900/50",children:[(0,a.jsx)("p",{children:"Thank you for choosing Hotelify Resort."}),(0,a.jsxs)("p",{className:"mt-1",children:["Generated on ",(0,l.WU)(new Date,"PPpp")]})]})]})]})}}},function(e){e.O(0,[2714,2971,8069,1744],function(){return e(e.s=32887)}),_N_E=e.O()}]);