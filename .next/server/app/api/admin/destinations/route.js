"use strict";(()=>{var e={};e.id=5444,e.ids=[5444,6511],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},15806:(e,t,n)=>{n.r(t),n.d(t,{headerHooks:()=>h,originalPathname:()=>v,patchFetch:()=>q,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>y});var r={};n.r(r),n.d(r,{GET:()=>d,POST:()=>p});var s=n(95419),a=n(69108),o=n(99678),i=n(98984),u=n(56511),l=n(39961),c=n(96467);async function d(){try{await (0,u.default)();let e=await l.o.find().sort({order:1,name:1});return i.NextResponse.json({destinations:e})}catch(e){return i.NextResponse.json({error:"Failed to fetch destinations"},{status:500})}}async function p(e){try{await (0,u.default)();let t=await (0,c.ts)();if(!t||"super_admin"!==t.role)return i.NextResponse.json({error:"Unauthorized"},{status:401});let n=await e.json();if(!n.name)return i.NextResponse.json({error:"Name is required"},{status:400});let r=n.slug||n.name.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"");if(await l.o.findOne({slug:r}))return i.NextResponse.json({error:"Slug already exists"},{status:400});let s=await l.o.create({name:n.name,slug:r,description:n.description,image:n.image,isActive:!1!==n.isActive,isFeatured:n.isFeatured||!1,order:n.order||0});return i.NextResponse.json({destination:s,message:"Destination created"},{status:201})}catch(e){return i.NextResponse.json({error:e.message||"Failed to create destination"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/destinations/route",pathname:"/api/admin/destinations",filename:"route",bundlePath:"app/api/admin/destinations/route"},resolvedPagePath:"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\api\\admin\\destinations\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:x,headerHooks:h,staticGenerationBailout:y}=m,v="/api/admin/destinations/route";function q(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:f})}},96467:(e,t,n)=>{n.d(t,{WX:()=>u,setAuthCookie:()=>l,signToken:()=>i,ts:()=>c});var r=n(46082),s=n.n(r),a=n(7439);let o=process.env.JWT_SECRET||"fallback-secret-key-change-me";function i(e,t="6h"){return s().sign(e,o,{expiresIn:t})}function u(e){try{return s().verify(e,o)}catch(e){return null}}function l(e,t=21600){(0,a.cookies)().set("auth_token",e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:t,path:"/"})}async function c(){let e=function(){let e=(0,a.cookies)();return e.get("auth_token")?.value}();return e?u(e):null}},56511:(e,t,n)=>{n.d(t,{default:()=>i});var r=n(11185),s=n.n(r);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let i=async function(){if(o.conn)return o.conn;o.promise||(o.promise=s().connect(a,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},39961:(e,t,n)=>{n.d(t,{o:()=>o});var r=n(11185),s=n.n(r);let a=new(s()).Schema({name:{type:String,required:!0},slug:{type:String,unique:!0,lowercase:!0,required:!0},description:{type:String},image:{type:String},isActive:{type:Boolean,default:!0},isFeatured:{type:Boolean,default:!1},order:{type:Number,default:0}},{timestamps:!0});s().models.Destination&&delete s().models.Destination;let o=s().model("Destination",a)}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[1638,7439,6082,2791],()=>n(15806));module.exports=r})();