"use strict";(()=>{var e={};e.id=2542,e.ids=[2542,6511],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},8492:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>b,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>x});var n={};r.r(n),r.d(n,{GET:()=>c,POST:()=>m});var a=r(95419),o=r(69108),s=r(99678),i=r(98984),l=r(56511),u=r(45197),p=r(96467);async function c(e){try{await (0,l.default)();let e=await u.f.find({}).sort({"pricing.monthly":1});return i.NextResponse.json({success:!0,plans:e})}catch(e){return console.error("Plans API error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let t=await (0,p.ts)();if(!t||"super_admin"!==t.role)return i.NextResponse.json({error:"Unauthorized"},{status:401});await (0,l.default)();let r=await e.json(),n={name:r.name,slug:r.name.toLowerCase().replace(/\s+/g,"-"),pricing:{monthly:r.monthlyPrice,yearly:r.yearlyPrice||12*r.monthlyPrice,currency:"BDT",smsCostPerUnit:r.smsCostPerUnit},features:{maxRooms:r.maxRooms,maxStaff:r.maxStaff,smsCreditsIncluded:r.smsCredits,posEnabled:r.posEnabled,housekeepingEnabled:r.housekeepingEnabled,customDomainEnabled:r.customDomainEnabled,reportsEnabled:!0},commissionRate:r.commissionRate,isCommissionBased:r.isCommissionBased,isVisible:r.isVisible,isActive:!0},a=await u.f.create(n);return i.NextResponse.json({success:!0,plan:a})}catch(e){return console.error("Create Plan Error:",e),i.NextResponse.json({error:e.message||"Error creating plan"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/plans/route",pathname:"/api/plans",filename:"route",bundlePath:"app/api/plans/route"},resolvedPagePath:"C:\\Users\\ismai\\.gemini\\antigravity\\playground\\primal-supernova\\src\\app\\api\\plans\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:y,serverHooks:g,headerHooks:h,staticGenerationBailout:x}=d,b="/api/plans/route";function v(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}},96467:(e,t,r)=>{r.d(t,{WX:()=>l,setAuthCookie:()=>u,signToken:()=>i,ts:()=>p});var n=r(46082),a=r.n(n),o=r(7439);let s=process.env.JWT_SECRET||"fallback-secret-key-change-me";function i(e,t="6h"){return a().sign(e,s,{expiresIn:t})}function l(e){try{return a().verify(e,s)}catch(e){return null}}function u(e,t=21600){(0,o.cookies)().set("auth_token",e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:t,path:"/"})}async function p(){let e=function(){let e=(0,o.cookies)();return e.get("auth_token")?.value}();return e?l(e):null}},56511:(e,t,r)=>{r.d(t,{default:()=>i});var n=r(11185),a=r.n(n);let o=process.env.MONGODB_URI;if(!o)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let s=global.mongoose;s||(s=global.mongoose={conn:null,promise:null});let i=async function(){if(s.conn)return s.conn;s.promise||(s.promise=a().connect(o,{bufferCommands:!1}).then(e=>e));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}},45197:(e,t,r)=>{r.d(t,{f:()=>s});var n=r(11185),a=r.n(n);let o=new(a()).Schema({name:{type:String,required:!0},slug:{type:String,unique:!0},pricing:{monthly:{type:Number,default:0},yearly:{type:Number,default:0},currency:{type:String,default:"BDT"},smsCostPerUnit:{type:Number,default:.5}},features:{maxRooms:{type:Number,default:10},maxStaff:{type:Number,default:3},maxBookingsPerMonth:{type:Number,default:100},customDomainEnabled:{type:Boolean,default:!1},posEnabled:{type:Boolean,default:!1},housekeepingEnabled:{type:Boolean,default:!1},reportsEnabled:{type:Boolean,default:!0},smsCreditsIncluded:{type:Number,default:0},templateAccess:{type:String,enum:["free","premium","all"],default:"free"},prioritySupport:{type:Boolean,default:!1},liveChat:{type:Boolean,default:!1},apiAccess:{type:Boolean,default:!1}},commissionRate:{type:Number,default:5,min:0,max:100},isCommissionBased:{type:Boolean,default:!0},isActive:{type:Boolean,default:!0},isVisible:{type:Boolean,default:!0},isDefault:{type:Boolean,default:!1},sortOrder:{type:Number,default:0}},{timestamps:!0}),s=a().models.Plan||a().model("Plan",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1638,7439,6082,2791],()=>r(8492));module.exports=n})();