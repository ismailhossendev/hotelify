(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6445],{16445:function(e,a,t){Promise.resolve().then(t.bind(t,53054))},50489:function(e,a,t){"use strict";t.d(a,{Z:function(){return l}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(70843).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},47907:function(e,a,t){"use strict";var l=t(15313);t.o(l,"notFound")&&t.d(a,{notFound:function(){return l.notFound}}),t.o(l,"useParams")&&t.d(a,{useParams:function(){return l.useParams}}),t.o(l,"useRouter")&&t.d(a,{useRouter:function(){return l.useRouter}}),t.o(l,"useSearchParams")&&t.d(a,{useSearchParams:function(){return l.useSearchParams}})},28402:function(e,a,t){"use strict";t.d(a,{Z:function(){return c}});var l=t(57437),r=t(2265),o=t(52235),s=t(79580),n=t(10632),i=t(20703);function c(e){let{images:a=[],onChange:t,maxImages:c=5}=e,[d,u]=(0,r.useState)(!1),m=(0,r.useRef)(null),p=async e=>{var l;let r=null===(l=e.target.files)||void 0===l?void 0:l[0];if(r){if(a.length>=c){alert("Maximum ".concat(c," images allowed."));return}u(!0);try{let e=await x(r),l=new FormData;l.append("file",e);let o=await fetch("/api/upload",{method:"POST",body:l}),s=await o.json();s.success?t([...a,s.url]):alert("Upload failed: "+s.error)}catch(e){console.error(e),alert("Upload error")}finally{u(!1),m.current&&(m.current.value="")}}},h=async(e,l)=>{confirm("Delete this image?")&&(t(a.filter((e,a)=>a!==l)),await fetch("/api/upload",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})}))},x=e=>new Promise((a,t)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=l=>{var r;let o=document.createElement("img");o.src=null===(r=l.target)||void 0===r?void 0:r.result,o.onload=()=>{let l=document.createElement("canvas"),r=1920/o.width,s=r<1?1920:o.width,n=r<1?o.height*r:o.height;l.width=s,l.height=n;let i=l.getContext("2d");null==i||i.drawImage(o,0,0,s,n),l.toBlob(e=>{e?a(e):t(Error("Canvas to Blob failed"))},e.type,.8)}},l.onerror=t});return(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-4",children:[a.map((e,a)=>(0,l.jsxs)("div",{className:"relative w-32 h-32 rounded-xl overflow-hidden border border-gray-200 group",children:[(0,l.jsx)(i.default,{src:e,alt:"Room ".concat(a+1),fill:!0,className:"object-cover"}),(0,l.jsx)("button",{type:"button",onClick:()=>h(e,a),className:"absolute top-1 right-1 bg-red-600 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,l.jsx)(o.Z,{className:"h-3 w-3"})})]},a)),a.length<c&&(0,l.jsxs)("div",{onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},className:"w-32 h-32 rounded-xl border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors text-gray-400 hover:text-blue-500",children:[d?(0,l.jsx)(s.Z,{className:"h-6 w-6 animate-spin"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{className:"h-6 w-6 mb-1"}),(0,l.jsx)("span",{className:"text-xs font-bold",children:"Upload"})]}),(0,l.jsx)("input",{ref:m,type:"file",accept:"image/*",className:"hidden",onChange:p})]})]}),(0,l.jsxs)("p",{className:"text-xs text-gray-400",children:[a.length," / ",c," images. Optimized automatically."]})]})}},53054:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(57437),r=t(2265),o=t(47907),s=t(79580),n=t(50489),i=t(28402);function c(e){var a,t,c,d;let{initialData:u,mode:m}=e,p=(0,o.useRouter)(),[h,x]=(0,r.useState)(!1),[b,g]=(0,r.useState)(!1),[y,f]=(0,r.useState)([]),[v,j]=(0,r.useState)({name:(null==u?void 0:u.name)||"",roomType:(null==u?void 0:u.roomType)||"double",description:(null==u?void 0:u.description)||"",basePrice:(null==u?void 0:u.basePrice)||0,capacity:{adults:(null==u?void 0:null===(a=u.capacity)||void 0===a?void 0:a.adults)||2,children:(null==u?void 0:null===(t=u.capacity)||void 0===t?void 0:t.children)||0},amenities:(null==u?void 0:null===(c=u.amenities)||void 0===c?void 0:c.join(", "))||"Wifi, TV, AC",images:(null==u?void 0:null===(d=u.images)||void 0===d?void 0:d.map(e=>e.url))||[]});(0,r.useEffect)(()=>{fetch("/api/config/room-types").then(e=>e.json()).then(e=>{e.success&&(f(e.types),"create"===m&&e.types.length>0&&j(a=>({...a,roomType:e.types[0].toLowerCase()})))})},[m]);let w=async e=>{e.preventDefault(),x(!0);let a={...v,hotelId:(null==u?void 0:u.hotelId)||"677f50a0058e519c2a66e4a3",amenities:v.amenities.split(",").map(e=>e.trim()).filter(Boolean),images:v.images.map(e=>({url:e,caption:"Room Image"}))},t="create"===m?"/api/rooms":"/api/rooms/".concat(u._id);try{let e=await fetch(t,{method:"create"===m?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});e.ok?(p.push("/rooms"),p.refresh()):alert("Error saving room: "+await e.text())}catch(e){console.error(e),alert("Something went wrong")}finally{x(!1)}},N=async()=>{if((null==u?void 0:u._id)&&confirm("Are you sure you want to delete this Room Type? This action cannot be undone.")){g(!0);try{(await fetch("/api/rooms/".concat(u._id),{method:"DELETE"})).ok?(p.push("/rooms"),p.refresh()):alert("Failed to delete room")}catch(e){alert("Error deleting room")}finally{g(!1)}}};return(0,l.jsxs)("form",{onSubmit:w,className:"space-y-6 max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold",children:"create"===m?"Add New Room Category":"Edit Room Category"}),"edit"===m&&(0,l.jsxs)("button",{type:"button",onClick:N,disabled:b,className:"text-red-600 hover:bg-red-50 p-2 rounded-lg flex items-center gap-2 text-sm font-bold",children:[b?(0,l.jsx)(s.Z,{className:"animate-spin h-4 w-4"}):(0,l.jsx)(n.Z,{className:"h-4 w-4"}),"Delete Room Type"]})]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Category Name"}),(0,l.jsx)("input",{required:!0,className:"w-full border rounded-lg px-4 py-2",placeholder:"e.g. Deluxe Sea View",value:v.name,onChange:e=>j({...v,name:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Room Type"}),(0,l.jsx)("select",{className:"w-full border rounded-lg px-4 py-2 capitalize",value:v.roomType,onChange:e=>j({...v,roomType:e.target.value}),children:y.length>0?y.map(e=>(0,l.jsx)("option",{value:e.toLowerCase(),children:e},e)):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"single",children:"Single"}),(0,l.jsx)("option",{value:"double",children:"Double"})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Base Price (Per Night)"}),(0,l.jsx)("input",{type:"number",required:!0,min:"0",className:"w-full border rounded-lg px-4 py-2 font-mono",value:v.basePrice,onChange:e=>j({...v,basePrice:parseInt(e.target.value)})})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Description"}),(0,l.jsx)("textarea",{className:"w-full border rounded-lg px-4 py-2 h-24",placeholder:"Describe the room view, decor, etc.",value:v.description,onChange:e=>j({...v,description:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Adult Capacity"}),(0,l.jsx)("input",{type:"number",min:"1",className:"w-full border rounded-lg px-4 py-2",value:v.capacity.adults,onChange:e=>j({...v,capacity:{...v.capacity,adults:parseInt(e.target.value)}})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Children Capacity"}),(0,l.jsx)("input",{type:"number",min:"0",className:"w-full border rounded-lg px-4 py-2",value:v.capacity.children,onChange:e=>j({...v,capacity:{...v.capacity,children:parseInt(e.target.value)}})})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Amenities (Comma Separated)"}),(0,l.jsx)("input",{className:"w-full border rounded-lg px-4 py-2",placeholder:"Wifi, AC, Geyser, Balcony",value:v.amenities,onChange:e=>j({...v,amenities:e.target.value})})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Images"}),(0,l.jsx)(i.Z,{images:v.images,onChange:e=>j({...v,images:e}),maxImages:5})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t mt-6",children:[(0,l.jsx)("button",{type:"button",onClick:()=>p.back(),className:"px-6 py-2 rounded-lg font-bold text-gray-600 hover:bg-gray-100",children:"Cancel"}),(0,l.jsxs)("button",{type:"submit",disabled:h,className:"px-6 py-2 rounded-lg font-bold bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[h&&(0,l.jsx)(s.Z,{className:"h-4 w-4 animate-spin"}),"create"===m?"Create Room Type":"Update Room Type"]})]})]})}}}]);