(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7801],{4545:function(e,t,s){Promise.resolve().then(s.bind(s,61218))},70843:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2265),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:r=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:o="",children:d,...u},m)=>(0,a.createElement)("svg",{ref:m,...l,width:r,height:r,stroke:s,strokeWidth:i?24*Number(c)/Number(r):c,className:["lucide",`lucide-${n(e)}`,o].join(" "),...u},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s}},80037:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},79580:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},70094:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},50489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},69724:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},52235:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},61218:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(57437),l=s(2265),n=s(79580),r=s(70094),c=s(50489),i=s(52235),o=s(69724),d=s(80037);function u(){let[e,t]=(0,l.useState)([]),[s,d]=(0,l.useState)(!0),[u,x]=(0,l.useState)(!1),[h,p]=(0,l.useState)({name:"",monthlyPrice:0,yearlyPrice:0,smsCostPerUnit:.5,maxRooms:10,maxStaff:3,smsCredits:0,commissionRate:5,isCommissionBased:!0,posEnabled:!1,housekeepingEnabled:!1,customDomainEnabled:!1,isVisible:!0}),[f,y]=(0,l.useState)(!1),[b,g]=(0,l.useState)(null),[j,N]=(0,l.useState)(""),[v,w]=(0,l.useState)({affectedHotels:0}),k=()=>{fetch("/api/plans").then(e=>e.json()).then(e=>{e.success&&t(e.plans),d(!1)}).catch(()=>d(!1))};(0,l.useEffect)(()=>{k()},[]);let C=async e=>{g(e);try{let t=await fetch("/api/plans/".concat(e._id,"/stats")),s=await t.json();w({affectedHotels:s.count||0}),y(!0)}catch(e){alert("Error checking plan usage")}},P=async()=>{if(v.affectedHotels>0&&!j){alert("Please select a replacement plan for current users");return}if(confirm("Are you sure? This action cannot be undone."))try{let e=await fetch("/api/plans/".concat(b._id),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({replacementPlanId:j})}),t=await e.json();t.success?(alert("Plan deleted and users migrated successfully"),y(!1),g(null),k()):alert("Failed: "+t.error)}catch(e){alert("Error deleting plan")}},S=async()=>{try{let e=await fetch("/api/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}),t=await e.json();t.success?(alert("Plan created successfully!"),x(!1),k()):alert("Failed: "+t.error)}catch(e){alert("Error creating plan")}};return s?(0,a.jsx)("div",{className:"p-8",children:(0,a.jsx)(n.Z,{className:"animate-spin text-purple-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Subscription Plans"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Manage pricing tiers and feature toggles"})]}),(0,a.jsxs)("button",{onClick:()=>x(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[(0,a.jsx)(r.Z,{className:"h-4 w-4"})," Create Plan"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl border p-6 flex flex-col relative ".concat(e.isVisible?"border-gray-700":"border-dashed border-gray-600 opacity-75"),children:[(0,a.jsx)("button",{onClick:()=>C(e),className:"absolute top-4 right-4 text-gray-500 hover:text-red-400 p-1",title:"Delete Plan",children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})}),(0,a.jsx)("div",{className:"flex justify-between items-start mb-4 pr-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[!e.isVisible&&"(Hidden) ",e.isDefault?"Default Plan":"Premium Tier"]})]})}),(0,a.jsxs)("div",{className:"text-3xl font-bold mb-2",children:["BDT ",e.pricing.monthly,(0,a.jsx)("span",{className:"text-sm font-normal text-gray-400",children:"/mo"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-400 mb-6",children:["BDT ",e.pricing.yearly,"/year • SMS: ",e.pricing.smsCostPerUnit," tk"]}),(0,a.jsxs)("div",{className:"space-y-3 mb-8 flex-1",children:[(0,a.jsx)(m,{label:"".concat(e.features.maxRooms," Rooms")}),(0,a.jsx)(m,{label:"".concat(e.features.maxStaff," Staff")}),(0,a.jsx)(m,{label:"".concat(e.features.smsCreditsIncluded," Free SMS")}),(0,a.jsx)(m,{label:e.features.posEnabled?"POS Included":"No POS",active:e.features.posEnabled}),(0,a.jsx)(m,{label:e.features.customDomainEnabled?"Custom Domain":"Subdomain Only",active:e.features.customDomainEnabled}),(0,a.jsx)(m,{label:"".concat(e.commissionRate,"% Commission")})]})]},e._id))}),u&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Create New Plan"}),(0,a.jsx)("button",{onClick:()=>x(!1),children:(0,a.jsx)(i.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{className:"w-full bg-gray-700 p-2 rounded",placeholder:"Plan Name",value:h.name,onChange:e=>p({...h,name:e.target.value})}),(0,a.jsx)("input",{type:"number",className:"w-full bg-gray-700 p-2 rounded",placeholder:"Monthly Price",value:h.monthlyPrice,onChange:e=>p({...h,monthlyPrice:Number(e.target.value)})}),(0,a.jsx)("button",{onClick:S,className:"w-full bg-purple-600 p-3 rounded font-bold",children:"Create"})]})]})}),f&&b&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 w-full max-w-md p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-red-400 flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"h-6 w-6"})," Delete Plan"]}),(0,a.jsx)("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-white",children:(0,a.jsx)(i.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-gray-300",children:["You are about to delete ",(0,a.jsx)("strong",{children:b.name}),"."]}),v.affectedHotels>0?(0,a.jsxs)("div",{className:"bg-yellow-900/20 border border-yellow-700/50 p-4 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-yellow-200 font-medium mb-2",children:["⚠️ ",v.affectedHotels," Hotels currently on this plan!"]}),(0,a.jsx)("p",{className:"text-sm text-yellow-400/80 mb-4",children:"You must select a new plan to move these hotels to."}),(0,a.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"Migrate users to:"}),(0,a.jsxs)("select",{className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white outline-none",value:j,onChange:e=>N(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select Replacement Plan"}),e.filter(e=>e._id!==b._id).map(e=>(0,a.jsxs)("option",{value:e._id,children:[e.name," - BDT ",e.pricing.monthly]},e._id))]})]}):(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"No active hotels found on this plan. Safe to delete."}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>y(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg",children:"Cancel"}),(0,a.jsx)("button",{onClick:P,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-bold",children:"Confirm Delete"})]})]})]})})]})}function m(e){let{label:t,active:s=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2 ".concat(s?"text-gray-300":"text-gray-500"),children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 ".concat(s?"text-green-500":"text-gray-600")}),(0,a.jsx)("span",{className:"text-sm",children:t})]})}}},function(e){e.O(0,[2971,8069,1744],function(){return e(e.s=4545)}),_N_E=e.O()}]);