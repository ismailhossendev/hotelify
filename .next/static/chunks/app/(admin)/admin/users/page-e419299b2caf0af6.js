(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8552],{29940:function(e,t,r){Promise.resolve().then(r.bind(r,67517))},70843:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(e,t)=>{let r=(0,s.forwardRef)(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:c,...u},x)=>(0,s.createElement)("svg",{ref:x,...a,width:n,height:n,stroke:r,strokeWidth:o?24*Number(i)/Number(n):i,className:["lucide",`lucide-${l(e)}`,d].join(" "),...u},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r}},83149:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},79580:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},70094:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},28670:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},52235:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},67517:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(57437),a=r(2265),l=r(79580),n=r(28670),i=r(70094),o=r(83149),d=r(52235);function c(){let[e,t]=(0,a.useState)([]),[r,d]=(0,a.useState)(!0),[c,x]=(0,a.useState)(""),[p,h]=(0,a.useState)("all"),[m,g]=(0,a.useState)("all"),[f,y]=(0,a.useState)(!1),[v,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{j()},[]);let j=()=>{fetch("/api/admin/users").then(e=>e.json()).then(e=>{e.success&&t(e.users),d(!1)}).catch(()=>d(!1))},N=async(e,r)=>{if(confirm("Are you sure you want to ".concat(r?"deactivate":"activate"," this user?"))){b(e);try{let s=await fetch("/api/admin/users/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!r})}),a=await s.json();a.success?t(t=>t.map(t=>t._id===e?{...t,isActive:!r}:t)):alert("Failed: "+a.error)}catch(e){console.error(e),alert("Error updating user status")}finally{b(null)}}},w=e.filter(e=>{var t,r,s,a;let l=(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(s=e.profile)||void 0===s?void 0:null===(r=s.name)||void 0===r?void 0:r.toLowerCase().includes(c.toLowerCase()))||(null===(a=e.role)||void 0===a?void 0:a.toLowerCase().includes(c.toLowerCase())),n="all"===p||e.role===p,i="all"===m||("active"===m?e.isActive:!e.isActive);return l&&n&&i}),k=e=>{switch(e){case"super_admin":return"bg-purple-900 text-purple-300";case"vendor_admin":return"bg-blue-900 text-blue-300";case"vendor_staff":return"bg-cyan-900 text-cyan-300";case"support_staff":return"bg-orange-900 text-orange-300";case"ticket_manager":return"bg-yellow-900 text-yellow-300";default:return"bg-gray-700 text-gray-300"}};return r?(0,s.jsx)("div",{className:"p-8",children:(0,s.jsx)(l.Z,{className:"animate-spin text-purple-500"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Users Management"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Manage all platform users"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-gray-800 rounded-lg px-4 py-2 border border-gray-700",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{className:"bg-transparent border-none outline-none text-white placeholder-gray-500 w-48",placeholder:"Search users...",value:c,onChange:e=>x(e.target.value)})]}),(0,s.jsxs)("select",{className:"bg-gray-800 text-sm text-white border border-gray-700 rounded-lg px-3 py-2 outline-none",value:p,onChange:e=>h(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Roles"}),(0,s.jsx)("option",{value:"super_admin",children:"Super Admin"}),(0,s.jsx)("option",{value:"vendor_admin",children:"Vendor Admin"}),(0,s.jsx)("option",{value:"vendor_staff",children:"Vendor Staff"}),(0,s.jsx)("option",{value:"support_staff",children:"Support Staff"}),(0,s.jsx)("option",{value:"guest",children:"Guest"})]}),(0,s.jsxs)("select",{className:"bg-gray-800 text-sm text-white border border-gray-700 rounded-lg px-3 py-2 outline-none",value:m,onChange:e=>g(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,s.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg font-medium transition-colors",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),"Add Staff"]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-900",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Contact"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Role"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Hotel"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-700",children:w.map(e=>{var t,r,a,n,i,d;return(0,s.jsxs)("tr",{className:"hover:bg-gray-750",children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center text-white font-bold",children:(null===(r=e.profile)||void 0===r?void 0:null===(t=r.name)||void 0===t?void 0:t[0])||(null===(n=e.email)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:a.toUpperCase())||"?"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-white",children:(null===(i=e.profile)||void 0===i?void 0:i.name)||"Unnamed"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:e.email})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-gray-300",children:e.phone||"N/A"}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(k(e.role)),children:null===(d=e.role)||void 0===d?void 0:d.replace("_"," ")})}),(0,s.jsx)("td",{className:"px-6 py-4 text-gray-300",children:e.hotelId?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o.Z,{className:"h-3 w-3"}),(0,s.jsx)("span",{className:"text-sm",children:e.hotelId.name||"Assigned"})]}):"None"}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.isActive?"bg-green-900 text-green-300":"bg-red-900 text-red-300"),children:e.isActive?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:(0,s.jsx)("button",{onClick:()=>N(e._id,e.isActive),disabled:v===e._id,className:"text-xs px-3 py-1.5 rounded border transition-colors ".concat(e.isActive?"border-red-500 text-red-400 hover:bg-red-500/10":"border-green-500 text-green-400 hover:bg-green-500/10"),children:v===e._id?(0,s.jsx)(l.Z,{className:"h-3 w-3 animate-spin"}):e.isActive?"Deactivate":"Activate"})})]},e._id)})})]}),0===w.length&&(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"No users found"})]}),f&&(0,s.jsx)(u,{onClose:()=>y(!1),onSuccess:()=>{y(!1),j()}})]})}function u(e){let{onClose:t,onSuccess:r}=e,[l,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)({name:"",email:"",password:"",role:"support_staff"}),c=async e=>{e.preventDefault(),n(!0);try{(await fetch("/api/admin/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?r():alert("Failed to create staff")}catch(e){console.error(e),alert("Error creating staff")}finally{n(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 w-full max-w-md p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Add New Staff"}),(0,s.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white",children:(0,s.jsx)(d.Z,{className:"h-5 w-5"})})]}),(0,s.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Full Name"}),(0,s.jsx)("input",{type:"text",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500 outline-none",value:i.name,onChange:e=>o({...i,name:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Email Address"}),(0,s.jsx)("input",{type:"email",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500 outline-none",value:i.email,onChange:e=>o({...i,email:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Password"}),(0,s.jsx)("input",{type:"password",required:!0,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500 outline-none",value:i.password,onChange:e=>o({...i,password:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Role"}),(0,s.jsxs)("select",{className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500 outline-none",value:i.role,onChange:e=>o({...i,role:e.target.value}),children:[(0,s.jsx)("option",{value:"support_staff",children:"Support Staff"}),(0,s.jsx)("option",{value:"ticket_manager",children:"Ticket Manager"}),(0,s.jsx)("option",{value:"super_admin",children:"Super Admin"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:l,className:"w-full bg-purple-600 hover:bg-purple-700 py-2 rounded-lg font-bold transition-colors disabled:opacity-50 mt-4",children:l?"Creating...":"Create Staff User"})]})]})})}}},function(e){e.O(0,[2971,8069,1744],function(){return e(e.s=29940)}),_N_E=e.O()}]);