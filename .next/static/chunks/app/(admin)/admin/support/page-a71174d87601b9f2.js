(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7862],{94757:function(e,s,t){Promise.resolve().then(t.bind(t,92231))},28670:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(70843).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},92231:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var a=t(57437),l=t(2265),r=t(79580),n=t(28670),i=t(62985),c=t(26490),o=t(34187),d=t(30438),x=t(58699);function u(){let[e,s]=(0,l.useState)([]),[t,u]=(0,l.useState)(!0),[p,h]=(0,l.useState)(""),[m,j]=(0,l.useState)("all"),[v,y]=(0,l.useState)(null),b=async()=>{try{let e=await fetch("/api/tickets"),t=await e.json();t.success&&s(t.tickets)}catch(e){console.error(e)}finally{u(!1)}};(0,l.useEffect)(()=>{b();let e=setInterval(b,3e4);return()=>clearInterval(e)},[]);let f=e.filter(e=>{var s,t;let a=e.subject.toLowerCase().includes(p.toLowerCase())||(null===(t=e.hotelId)||void 0===t?void 0:null===(s=t.name)||void 0===s?void 0:s.toLowerCase().includes(p.toLowerCase()))||e._id.includes(p),l="all"===m||e.status===m;return a&&l});return t?(0,a.jsx)("div",{className:"p-8",children:(0,a.jsx)(r.Z,{className:"animate-spin text-purple-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Support Desk"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Manage vendor support tickets"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-gray-800 rounded-lg px-4 py-2 border border-gray-700",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{className:"bg-transparent border-none outline-none text-white placeholder-gray-500 w-48",placeholder:"Search tickets...",value:p,onChange:e=>h(e.target.value)})]})})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-4",children:["all","open","in_progress","resolved"].map(s=>(0,a.jsxs)("button",{onClick:()=>j(s),className:"p-4 rounded-xl border transition-all ".concat(m===s?"bg-purple-900/20 border-purple-500 ring-1 ring-purple-500":"bg-gray-800 border-gray-700 hover:border-gray-600"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"capitalize font-bold text-gray-300",children:"all"===s?"All Tickets":s.replace("_"," ")}),"open"===s&&(0,a.jsx)(i.Z,{className:"h-5 w-5 text-red-500"}),"in_progress"===s&&(0,a.jsx)(c.Z,{className:"h-5 w-5 text-yellow-500"}),"resolved"===s&&(0,a.jsx)(o.Z,{className:"h-5 w-5 text-green-500"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"all"===s?e.length:e.filter(e=>e.status===s).length})]},s))}),(0,a.jsxs)("div",{className:"space-y-4",children:[f.map(e=>{var s,t,l;return(0,a.jsx)("div",{onClick:()=>y(e),className:"bg-gray-800 rounded-xl p-4 border border-gray-700 hover:border-gray-500 cursor-pointer transition-colors group",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"mt-1 p-2 rounded-lg ".concat("urgent"===e.priority?"bg-red-900/50 text-red-400":"high"===e.priority?"bg-orange-900/50 text-orange-400":"bg-gray-700 text-gray-400"),children:(0,a.jsx)(d.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-white group-hover:text-purple-400 transition-colors",children:e.subject}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-400",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),(null===(s=e.hotelId)||void 0===s?void 0:s.name)||"Unknown Hotel"]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:new Date(e.lastReplyAt||e.createdAt).toLocaleString()}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"capitalize",children:e.category})]}),(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-2 line-clamp-1",children:null===(t=e.messages[e.messages.length-1])||void 0===t?void 0:t.message})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,a.jsx)(g,{status:e.status}),e.assignedTo&&(0,a.jsx)("span",{className:"text-xs text-gray-500",title:"Assigned Agent",children:null===(l=e.assignedTo.profile)||void 0===l?void 0:l.name})]})]})},e._id)}),0===f.length&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No tickets found matching your filters."})]}),v&&(0,a.jsx)(x.Z,{ticket:v,onClose:()=>y(null),onRefresh:()=>{b(),y(null)}})]})}function g(e){let{status:s}=e;return(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium uppercase tracking-wide ".concat({open:"bg-green-900 text-green-300",in_progress:"bg-yellow-900 text-yellow-300",resolved:"bg-blue-900 text-blue-300",closed:"bg-gray-700 text-gray-300"}[s]||"bg-gray-700"),children:s.replace("_"," ")})}}},function(e){e.O(0,[9513,2971,8069,1744],function(){return e(e.s=94757)}),_N_E=e.O()}]);