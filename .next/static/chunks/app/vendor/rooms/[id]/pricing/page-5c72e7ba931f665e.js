(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[723],{71135:function(e,t,r){Promise.resolve().then(r.bind(r,93485))},53879:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},79580:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},70699:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(70843).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},47907:function(e,t,r){"use strict";var s=r(15313);r.o(s,"notFound")&&r.d(t,{notFound:function(){return s.notFound}}),r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},93485:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(57437),n=r(2265),a=r(37814),i=r(62848),l=r(34161),d=r(72803),c=r(49495),o=r(19139),u=r(59663),x=r(6317);function h(e,t,r){return(0,x.z)(e,12*t,r)}var p=r(34414),g=r(61707),m=r(23671),b=r(79580),f=r(53879),v=r(70699),y=r(47907);function j(e){let{params:t}=e,r=(0,y.useRouter)(),[j,N]=(0,n.useState)(null),[w,k]=(0,n.useState)(!0),[S,M]=(0,n.useState)(!1),[C,D]=(0,n.useState)("month"),[P,F]=(0,n.useState)(new Date),[R,W]=(0,n.useState)(null),[T,Z]=(0,n.useState)(""),[z,H]=(0,n.useState)(0),[O,U]=(0,n.useState)(0),[Y,L]=(0,n.useState)(!0);(0,n.useEffect)(()=>{fetch("/api/rooms/".concat(t.id)).then(e=>e.json()).then(e=>{if(e.success){var t,r,s;let n=e.room;N(n),H(n.basePrice),U((null===(t=n.weekendPricing)||void 0===t?void 0:t.price)||n.basePrice),L(null===(s=null===(r=n.weekendPricing)||void 0===r?void 0:r.enabled)||void 0===s||s)}k(!1)})},[t.id]);let Q=(0,n.useMemo)(()=>(0,a.D)({start:(0,i.N)(P),end:(0,l.V)(P)}),[P]),_=e=>{var t;if(!j)return{price:0,type:"loading"};let r=null===(t=j.specialRates)||void 0===t?void 0:t.find(t=>(0,d.K)(new Date(t.date),e));if(r)return{price:r.price,type:"special"};let s=5===(0,c.Q)(e,void 0).getDay()||6===(0,c.Q)(e,void 0).getDay();return Y&&s?{price:O,type:"weekend"}:{price:z,type:"base"}},A=async()=>{M(!0),await fetch("/api/rooms/".concat(t.id,"/pricing"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({basePrice:z,weekendPricing:{enabled:Y,price:O,days:[5,6]}})}),M(!1),alert("Pricing Updated!")},E=async()=>{if(!R||!T)return;let e={date:R,price:parseInt(T),note:"Manual Override"},r=[...j.specialRates||[],e];await fetch("/api/rooms/".concat(t.id,"/pricing"),{method:"POST",body:JSON.stringify({specialRates:r})}),N({...j,specialRates:r}),W(null),Z("")};return w?(0,s.jsx)("div",{className:"flex justify-center p-10",children:(0,s.jsx)(b.Z,{className:"animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-6 max-w-6xl mx-auto pb-20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>r.back(),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)(f.Z,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold",children:["Pricing Manager: ",j.name]}),(0,s.jsx)("p",{className:"text-gray-500",children:"Set dynamic rates for seasons and weekends"})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"md:col-span-2 bg-white p-6 rounded-2xl border border-gray-200 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,s.jsx)("button",{onClick:()=>D("month"),className:"px-3 py-1 rounded text-sm font-bold transition-all ".concat("month"===C?"bg-white shadow text-blue-600":"text-gray-500"),children:"Month"}),(0,s.jsx)("button",{onClick:()=>D("year"),className:"px-3 py-1 rounded text-sm font-bold transition-all ".concat("year"===C?"bg-white shadow text-blue-600":"text-gray-500"),children:"Year"})]}),(0,s.jsx)("h2",{className:"font-bold text-lg",children:"month"===C?(0,o.WU)(P,"MMMM yyyy"):(0,o.WU)(P,"yyyy")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>F(e=>"month"===C?(0,u.W)(e,1):h(e,-1,void 0)),className:"p-2 border rounded-lg hover:bg-gray-50",children:"←"}),(0,s.jsx)("button",{onClick:()=>F(e=>"month"===C?(0,x.z)(e,1):h(e,1)),className:"p-2 border rounded-lg hover:bg-gray-50",children:"→"})]})]}),"year"===C?(0,s.jsx)("div",{className:"grid grid-cols-3 gap-6",children:(function(e,t){let{start:r,end:s}=(0,p.T)(t?.in,e),n=+r>+s,a=n?+r:+s,i=n?s:r;i.setHours(0,0,0,0),i.setDate(1);let l=t?.step??1;if(!l)return[];l<0&&(l=-l,n=!n);let d=[];for(;+i<=a;)d.push((0,g.L)(r,i)),i.setMonth(i.getMonth()+l);return n?d.reverse():d})({start:(0,m.e)(P),end:function(e,t){let r=(0,c.Q)(e,void 0),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}(P)}).map(e=>(0,s.jsxs)("div",{className:"border rounded-xl p-3 hover:border-blue-300 cursor-pointer transition-colors",onClick:()=>{F(e),D("month")},children:[(0,s.jsx)("h3",{className:"font-bold text-center text-sm mb-2",children:(0,o.WU)(e,"MMMM")}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-0.5 text-[0.6rem] text-center text-gray-400 mb-1",children:[(0,s.jsx)("div",{children:"S"}),(0,s.jsx)("div",{children:"M"}),(0,s.jsx)("div",{children:"T"}),(0,s.jsx)("div",{children:"W"}),(0,s.jsx)("div",{children:"T"}),(0,s.jsx)("div",{className:"text-red-300",children:"F"}),(0,s.jsx)("div",{className:"text-red-300",children:"S"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-0.5",children:[Array.from({length:(0,i.N)(e).getDay()}).map((e,t)=>(0,s.jsx)("div",{},"empty-".concat(t))),(0,a.D)({start:(0,i.N)(e),end:(0,l.V)(e)}).map(e=>{let{type:t}=_(e),r="bg-gray-100 text-gray-400";return"special"===t?r="bg-purple-500 text-white":"weekend"===t?r="bg-orange-400 text-white":"base"===t&&(r="bg-blue-50 text-blue-900"),(0,s.jsx)("div",{className:"aspect-square flex items-center justify-center rounded-[2px] text-[0.6rem] ".concat(r),children:(0,o.WU)(e,"d")},e.toString())})]})]},e.toString()))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-2 mb-2 text-center text-sm font-bold text-gray-400",children:[(0,s.jsx)("div",{children:"Sun"}),(0,s.jsx)("div",{children:"Mon"}),(0,s.jsx)("div",{children:"Tue"}),(0,s.jsx)("div",{children:"Wed"}),(0,s.jsx)("div",{children:"Thu"}),(0,s.jsx)("div",{className:"text-red-400",children:"Fri"}),(0,s.jsx)("div",{className:"text-red-400",children:"Sat"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:Q[0].getDay()}).map((e,t)=>(0,s.jsx)("div",{},"empty-".concat(t))),Q.map((e,t)=>{let{price:r,type:n}=_(e),a="weekend"===n,i="special"===n;return(0,s.jsxs)("div",{onClick:()=>W(e),className:"\n                                                p-2 rounded-xl border text-center cursor-pointer transition-all hover:scale-105 active:scale-95\n                                                ".concat(i?"bg-purple-100 border-purple-300 ring-2 ring-purple-200":"","\n                                                ").concat(a?"bg-orange-50 border-orange-200":"bg-white border-gray-100","\n                                                ").concat((0,d.K)(e,new Date)?"ring-2 ring-blue-500 ring-offset-1":"","\n                                                ").concat((0,d.K)(e,R||new Date(0))?"ring-2 ring-black ring-offset-1":"","\n                                            "),children:[(0,s.jsx)("div",{className:"text-xs mb-1 ".concat(a?"text-red-500 font-bold":"text-gray-500"),children:(0,o.WU)(e,"d")}),(0,s.jsxs)("div",{className:"text-sm font-bold ".concat(i?"text-purple-700":a?"text-orange-700":"text-gray-700"),children:["৳",r]})]},t)})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex gap-6 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded bg-white border border-gray-200"})," Regular"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded bg-orange-50 border border-orange-200"})," Weekend"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded bg-purple-100 border border-purple-200"})," Special Rate"]})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm",children:[(0,s.jsxs)("h3",{className:"font-bold mb-4 flex items-center gap-2",children:[(0,s.jsx)(v.Z,{className:"h-5 w-5"})," Base Rules"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Base Price (Global)"}),(0,s.jsx)("input",{type:"number",value:z,onChange:e=>H(parseInt(e.target.value)),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),(0,s.jsxs)("div",{className:"pt-4 border-t border-gray-100",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-700",children:"Weekend Surge"}),(0,s.jsx)("input",{type:"checkbox",checked:Y,onChange:e=>L(e.target.checked),className:"h-5 w-5 text-blue-600 rounded"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Applies to Friday & Saturday"}),(0,s.jsx)("input",{type:"number",value:O,disabled:!Y,onChange:e=>U(parseInt(e.target.value)),className:"w-full border border-gray-300 rounded-lg px-3 py-2 disabled:bg-gray-100 disabled:text-gray-400"})]}),(0,s.jsx)("button",{onClick:A,disabled:S,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition-colors",children:S?"Saving...":"Save Default Rates"})]})]}),R&&(0,s.jsxs)("div",{className:"bg-purple-50 p-6 rounded-2xl border border-purple-100 animate-in slide-in-from-right",children:[(0,s.jsxs)("h3",{className:"font-bold mb-2 text-purple-900",children:["Set Rate for ",(0,o.WU)(R,"MMM d")]}),(0,s.jsx)("p",{className:"text-xs text-purple-700 mb-4",children:"Override base & weekend rates for this specific date."}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"number",placeholder:"New Price",className:"flex-1 border border-purple-200 rounded-lg px-3 py-2",value:T,onChange:e=>Z(e.target.value)}),(0,s.jsx)("button",{onClick:E,className:"bg-purple-600 text-white px-4 rounded-lg font-bold hover:bg-purple-700",children:"Set"})]}),(0,s.jsx)("button",{onClick:()=>W(null),className:"text-xs text-center w-full mt-2 text-gray-500 hover:underline",children:"Cancel"})]})]})]})]})}},34414:function(e,t,r){"use strict";r.d(t,{T:function(){return n}});var s=r(43097);function n(e,t){let[r,n]=(0,s.d)(e,t.start,t.end);return{start:r,end:n}}},6317:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var s=r(61707),n=r(49495);function a(e,t,r){let a=(0,n.Q)(e,r?.in);if(isNaN(t))return(0,s.L)(r?.in||e,NaN);if(!t)return a;let i=a.getDate(),l=(0,s.L)(r?.in||e,a.getTime());return(l.setMonth(a.getMonth()+t+1,0),i>=l.getDate())?l:(a.setFullYear(l.getFullYear(),l.getMonth(),i),a)}},37814:function(e,t,r){"use strict";r.d(t,{D:function(){return a}});var s=r(34414),n=r(61707);function a(e,t){let{start:r,end:a}=(0,s.T)(t?.in,e),i=+r>+a,l=i?+r:+a,d=i?a:r;d.setHours(0,0,0,0);let c=t?.step??1;if(!c)return[];c<0&&(c=-c,i=!i);let o=[];for(;+d<=l;)o.push((0,n.L)(r,d)),d.setDate(d.getDate()+c),d.setHours(0,0,0,0);return i?o.reverse():o}},34161:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var s=r(49495);function n(e,t){let r=(0,s.Q)(e,t?.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}},72803:function(e,t,r){"use strict";r.d(t,{K:function(){return a}});var s=r(43097),n=r(65146);function a(e,t,r){let[a,i]=(0,s.d)(r?.in,e,t);return+(0,n.b)(a)==+(0,n.b)(i)}},62848:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});var s=r(49495);function n(e,t){let r=(0,s.Q)(e,t?.in);return r.setDate(1),r.setHours(0,0,0,0),r}},59663:function(e,t,r){"use strict";r.d(t,{W:function(){return n}});var s=r(6317);function n(e,t,r){return(0,s.z)(e,-t,r)}}},function(e){e.O(0,[2714,2971,8069,1744],function(){return e(e.s=71135)}),_N_E=e.O()}]);