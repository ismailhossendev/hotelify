(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9985],{76020:function(e,t,s){Promise.resolve().then(s.bind(s,44811))},70843:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=(e,t)=>{let s=(0,r.forwardRef)(({color:s="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,...u},m)=>(0,r.createElement)("svg",{ref:m,...a,width:o,height:o,stroke:s,strokeWidth:i?24*Number(l)/Number(o):l,className:["lucide",`lucide-${n(e)}`,c].join(" "),...u},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s}},53879:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},51930:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},37841:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},15474:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]])},79580:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},51652:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},90684:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},69724:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(70843).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8792:function(e,t,s){"use strict";s.d(t,{default:function(){return a.a}});var r=s(25250),a=s.n(r)},47907:function(e,t,s){"use strict";var r=s(15313);s.o(r,"notFound")&&s.d(t,{notFound:function(){return r.notFound}}),s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},44811:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(57437),a=s(2265),n=s(8792),o=s(47907),l=s(69724),i=s(90684),c=s(79580),d=s(15474),u=s(51652),m=s(51930),f=s(37841),h=s(53879);function x(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)(),[s,x]=(0,a.useState)("EMAIL"),[p,y]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[w,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[k,S]=(0,a.useState)(!1),[Z,P]=(0,a.useState)(!1),[C,O]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=t.get("email"),s=t.get("otp"),r=t.get("autoverify");e&&(y(e),x(e=>"EMAIL"===e?"OTP":e)),s&&g(s),e&&s&&"true"===r&&(async()=>{P(!0);try{let t=await fetch("/api/auth/forgot-password/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:s})}),r=await t.json();if(!t.ok)throw Error(r.error||"Invalid OTP");x("PASSWORD")}catch(e){O(e.message||"Auto-verification failed: Invalid Link")}finally{P(!1)}})()},[t]);let A=async e=>{e.preventDefault(),P(!0),O("");try{let e=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p})}),t=await e.json();if(!e.ok){if(404===e.status)O(t.error||"Account not found. Please create a new account.");else throw Error(t.error||"Something went wrong");return}x("OTP")}catch(e){O(e.message)}finally{P(!1)}},E=async e=>{e.preventDefault(),P(!0),O("");try{let e=await fetch("/api/auth/forgot-password/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p,otp:b})}),t=await e.json();if(!e.ok)throw Error(t.error||"Invalid OTP");x("PASSWORD")}catch(e){O(e.message)}finally{P(!1)}},L=async t=>{if(t.preventDefault(),w!==v){O("Passwords do not match");return}if(w.length<6){O("Password must be at least 6 characters");return}P(!0),O("");try{let t=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p,otp:b,password:w})}),s=await t.json();if(!t.ok)throw Error(s.error||"Reset failed");e.push("/login?reset=success")}catch(e){O(e.message)}finally{P(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8 font-sans",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto h-12 w-12 relative mb-4",children:(0,r.jsx)("img",{src:"/logo.png",alt:"Hotelify",className:"w-full h-full object-contain"})}),(0,r.jsxs)("h2",{className:"text-3xl font-bold tracking-tight text-gray-900",children:["EMAIL"===s&&"Forgot password?","OTP"===s&&"Check your email","PASSWORD"===s&&"Set new password"]}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["EMAIL"===s&&"Enter your email to receive a verification code.","OTP"===s&&"We sent a 6-digit code to ".concat(p,"."),"PASSWORD"===s&&"Secure your account with a new password."]})]}),(0,r.jsxs)("div",{className:"bg-white py-8 px-4 shadow-xl shadow-gray-200/50 border border-gray-100 sm:rounded-2xl sm:px-10",children:[C&&(0,r.jsxs)("div",{className:"rounded-lg bg-red-50 p-4 mb-6 border border-red-100 flex gap-3 text-red-700 text-sm",children:[(0,r.jsx)(l.Z,{className:"h-5 w-5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[C," ",C.includes("not found")&&(0,r.jsx)(n.default,{href:"/register",className:"underline font-bold ml-1",children:"Create account"})]})]}),"EMAIL"===s&&(0,r.jsxs)("form",{className:"space-y-6",onSubmit:A,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 pb-1",children:"Email address"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(i.Z,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{id:"email",type:"email",required:!0,className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your email",value:p,onChange:e=>y(e.target.value)})]})]}),(0,r.jsx)("button",{type:"submit",disabled:Z,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-xl shadow-sm text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:Z?(0,r.jsx)(c.Z,{className:"h-5 w-5 animate-spin"}):"Send Code"})]}),"OTP"===s&&(0,r.jsxs)("form",{className:"space-y-6",onSubmit:E,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 pb-1",children:"Verification Code"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:"text",required:!0,maxLength:6,className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 sm:text-sm tracking-widest font-mono text-lg",placeholder:"000000",value:b,onChange:e=>g(e.target.value.replace(/[^0-9]/g,""))})]})]}),(0,r.jsx)("button",{type:"submit",disabled:Z,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-xl shadow-sm text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:Z?(0,r.jsx)(c.Z,{className:"h-5 w-5 animate-spin"}):"Verify Code"}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>x("EMAIL"),className:"text-sm text-blue-600 hover:underline",children:"Wrong email? Go back"})})]}),"PASSWORD"===s&&(0,r.jsxs)("form",{className:"space-y-6",onSubmit:L,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 pb-1",children:"New Password"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:k?"text":"password",required:!0,minLength:6,className:"block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"••••••••",value:w,onChange:e=>j(e.target.value)}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>S(!k),children:k?(0,r.jsx)(m.Z,{className:"h-5 w-5"}):(0,r.jsx)(f.Z,{className:"h-5 w-5"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 pb-1",children:"Confirm Password"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:k?"text":"password",required:!0,minLength:6,className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"••••••••",value:v,onChange:e=>N(e.target.value)})]})]}),(0,r.jsx)("button",{type:"submit",disabled:Z,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-xl shadow-sm text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:Z?(0,r.jsx)(c.Z,{className:"h-5 w-5 animate-spin"}):"Reset Password"})]}),"EMAIL"===s&&(0,r.jsx)("div",{className:"text-center mt-6",children:(0,r.jsxs)(n.default,{href:"/login",className:"flex items-center justify-center text-sm font-medium text-gray-500 hover:text-gray-900 transition-colors",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4 mr-1"})," Back to log in"]})})]})]})})}function p(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)(c.Z,{className:"h-8 w-8 animate-spin text-blue-600"})}),children:(0,r.jsx)(x,{})})}}},function(e){e.O(0,[5250,2971,8069,1744],function(){return e(e.s=76020)}),_N_E=e.O()}]);