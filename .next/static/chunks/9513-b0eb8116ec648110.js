"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9513],{70843:function(e,t,s){s.d(t,{Z:function(){return l}});var a=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:d,...u},p)=>(0,a.createElement)("svg",{ref:p,...r,width:l,height:l,stroke:s,strokeWidth:c?24*Number(i)/Number(l):i,className:["lucide",`lucide-${n(e)}`,o].join(" "),...u},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s}},62985:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},34187:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},26490:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},79580:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},30438:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},80223:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},79990:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},77326:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},11213:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},52235:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(70843).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},58699:function(e,t,s){s.d(t,{Z:function(){return x}});var a=s(57437),r=s(2265),n=s(26490),l=s(62985),i=s(34187),c=s(52235),o=s(11213),d=s(77326),u=s(80223),p=s(79990);function x(e){let{ticket:t,onClose:s,onRefresh:x}=e,[h,m]=(0,r.useState)(""),[y,f]=(0,r.useState)(!1),g=(0,r.useRef)(null),b=()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{b()},[t.messages]);let j=async e=>{if(e.preventDefault(),h.trim()){f(!0);try{let e=await fetch("/api/tickets/".concat(t._id,"/reply"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:h})});(await e.json()).success?(m(""),x()):alert("Failed to send reply")}catch(e){console.error(e)}finally{f(!1)}}},w=async e=>{try{(await fetch("/api/tickets/".concat(t._id,"/reply"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"Status changed to ".concat(e),status:e})})).ok&&x()}catch(e){console.error(e)}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl h-[80vh] flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b flex justify-between items-start bg-gray-50",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ".concat((e=>{switch(e){case"open":return"bg-green-100 text-green-700";case"in_progress":return"bg-yellow-100 text-yellow-700";case"resolved":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}})(t.status)),children:t.status.replace("_"," ")}),(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:["#",t._id.slice(-6).toUpperCase()]})]}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t.subject}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),new Date(t.createdAt).toLocaleString()]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),t.priority.toUpperCase()," priority"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1 capitalize",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),t.category]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("select",{className:"bg-white border text-sm rounded-lg px-3 py-2 outline-none",value:t.status,onChange:e=>w(e.target.value),children:[(0,a.jsx)("option",{value:"open",children:"Open"}),(0,a.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,a.jsx)("option",{value:"resolved",children:"Resolved"}),(0,a.jsx)("option",{value:"closed",children:"Closed"})]}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-red-500 transition-colors",children:(0,a.jsx)(c.Z,{className:"h-6 w-6"})})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-gray-100",children:[t.messages.map((e,s)=>{"Support Agent"===e.senderName||e.senderName;let r=e.senderId===t.userId._id||e.senderId===t.userId;return(0,a.jsx)("div",{className:"flex ".concat(r?"justify-start":"justify-end"),children:(0,a.jsxs)("div",{className:"max-w-[80%] rounded-2xl p-4 shadow-sm ".concat(r?"bg-white text-gray-900 rounded-tl-none":"bg-blue-600 text-white rounded-tr-none"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 opacity-80 text-xs",children:[r?(0,a.jsx)(o.Z,{className:"h-3 w-3"}):(0,a.jsx)(d.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"font-bold",children:e.senderName}),(0,a.jsx)("span",{children:"â€¢"}),(0,a.jsx)("span",{children:new Date(e.sentAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"whitespace-pre-wrap leading-relaxed",children:e.message})]})},s)}),(0,a.jsx)("div",{ref:g})]}),(0,a.jsx)("div",{className:"p-4 bg-white border-t",children:(0,a.jsxs)("form",{onSubmit:j,className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("textarea",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 pr-12 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none h-[60px]",placeholder:"Type your reply...",value:h,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j(e))}}),(0,a.jsx)("button",{type:"button",className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(u.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)("button",{type:"submit",disabled:y||!h.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center aspect-square h-[60px]",children:y?(0,a.jsx)(n.Z,{className:"h-6 w-6 animate-spin"}):(0,a.jsx)(p.Z,{className:"h-6 w-6"})})]})})]})})}}}]);